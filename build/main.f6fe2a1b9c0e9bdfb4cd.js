!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/rhythm-cooker/",i(i.s=1)}([function(t,e,i){(function(e){!function(i){"use strict";var n=function(){return d.apply(null,arguments)},s=Array.prototype.slice,r=[8e3,11025,12e3,16e3,22050,24e3,32e3,44100,48e3],a=[32,64,128,256],o=null,u={},h={},l="undefined"!=typeof window?"browser":t.exports?"node":"unknown",c="browser"===l&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),f=!1,p=120,d=function(){var t,e,n=s.call(arguments),r=n[0];switch(typeof r){case"string":u[r]?t=new u[r](n.slice(1)):h[r]?t=h[r](n.slice(1)):(e=/^(.+?)(?:\.(ar|kr))?$/.exec(r))&&(r=e[1],u[r]?t=new u[r](n.slice(1)):h[r]&&(t=h[r](n.slice(1))),t&&e[2]&&t[e[2]]());break;case"number":t=new T(n);break;case"boolean":t=new R(n);break;case"function":t=new O(n);break;case"object":if(null!==r){if(r instanceof S)return r;if(r.context instanceof S)return r.context;b(r)?t=new D(n):g(r)&&(t=new M(n))}}t===i&&(t=new I(n.slice(1)),console.warn('T("'+r+'") is not defined.'));var a=t._;return a.originkey=r,a.meta=m(t),a.emit("init"),t},m=function(t){for(var e,i,n=t._.meta,s=t;null!==s&&s.constructor!==Object;){for(var r=0,a=(e=Object.getOwnPropertyNames(s)).length;a>r;++r)n[e[r]]||(/^(constructor$|process$|_)/.test(e[r])?n[e[r]]="ignore":"function"==typeof(i=Object.getOwnPropertyDescriptor(s,e[r])).value?n[e[r]]="function":(i.get||i.set)&&(n[e[r]]="property"));s=Object.getPrototypeOf(s)}return n};Object.defineProperties(n,{version:{value:"14.10.12"},envtype:{value:l},envmobile:{value:c},env:{get:function(){return o.impl.env}},samplerate:{get:function(){return o.samplerate}},channels:{get:function(){return o.channels}},cellsize:{get:function(){return o.cellsize}},currentTime:{get:function(){return o.currentTime}},isPlaying:{get:function(){return 1===o.status}},isRecording:{get:function(){return 3===o.status}},amp:{set:function(t){"number"==typeof t&&(o.amp=t)},get:function(){return o.amp}},bpm:{set:function(t){"number"==typeof t&&t>=5&&300>=t&&(p=t)},get:function(){return p}}}),n.bind=function(t,e){return o.bind(t,e),n},n.setup=function(t){return o.setup(t),n},n.play=function(){return o.play(),n},n.pause=function(){return o.pause(),n},n.reset=function(){return o.reset(),o.events.emit("reset"),n},n.on=n.addListener=function(t,e){return o.on(t,e),n},n.once=function(t,e){return o.once(t,e),n},n.off=n.removeListener=function(t,e){return o.off(t,e),n},n.removeAllListeners=function(t){return o.removeAllListeners(t),n},n.listeners=function(t){return o.listeners(t)},n.rec=function(){return o.rec.apply(o,arguments)},n.timevalue=function(){var t=function(t){var e,i=p;return(e=/^bpm(\d+(?:\.\d+)?)/i.exec(t))&&(i=Math.max(5,Math.min(300,+(e[1]||0)))),i};return function(e){var i,s;if(i=/^(\d+(?:\.\d+)?)Hz$/i.exec(e))return 0==+i[1]?0:1e3/+i[1];if(i=/L(\d+)?(\.*)$/i.exec(e))return 60/t(e)*(4/(i[1]||4))*1e3*([1,1.5,1.75,1.875][(i[2]||"").length]||1);if(i=/^(\d+(?:\.\d+)?|\.(?:\d+))(min|sec|m)s?$/i.exec(e))switch(i[2]){case"min":return 60*+(i[1]||0)*1e3;case"sec":return 1e3*+(i[1]||0);case"m":return+(i[1]||0)}return(i=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(e))?s=1e3*(s=3600*(i[1]||0)+60*(i[2]||0)+(i[3]||0))+(0|((i[4]||"")+"00").substr(0,3)):(i=/(\d+)\.(\d+)\.(\d+)$/i.exec(e))?(s=480*(4*i[1]+ +i[2])+ +i[3],60/t(e)*(s/480)*1e3):(i=/(\d+)ticks$/i.exec(e))?60/t(e)*(i[1]/480)*1e3:(i=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(e))?1e3*i[1]/(i[2]||n.samplerate):0}}();var v=n.fn={SignalArray:Float32Array,currentTimeIncr:0,emptycell:null,FINISHED_STATE:0,PLAYING_STATE:1,UNSCHEDULED_STATE:2,SCHEDULED_STATE:3},g=v.isArray=Array.isArray,b=v.isDictionary=function(t){return"object"==typeof t&&t.constructor===Object};v.nop=function(){return this},v.isSignalArray=function(t){return t instanceof v.SignalArray||!(!Array.isArray(t)||!t.__klass||2!==t.__klass.type)},v.extend=function(t,e){function i(){this.constructor=t}for(var n in e=e||S)e.hasOwnProperty(n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},v.constructorof=function(t,e){for(var i=t&&t.prototype;i;){if(i===e.prototype)return!0;i=Object.getPrototypeOf(i)}return!1},v.register=function(t,e){v.constructorof(e,S)?u[t]=e:h[t]=e},v.alias=function(t,e){u[e]?u[t]=u[e]:h[e]&&(h[t]=h[e])},v.getClass=function(t){return u[t]},v.pointer=function(t,e,i){return e=t.byteOffset+e*t.constructor.BYTES_PER_ELEMENT,"number"==typeof i?new t.constructor(t.buffer,e,i):new t.constructor(t.buffer,e)},v.nextTick=function(t){return o.nextTick(t),n},v.fixAR=function(t){t._.ar=!0,t._.aronly=!0},v.fixKR=function(t){t._.ar=!1,t._.kronly=!0},v.changeWithValue=function(){var t=this._,e=t.value*t.mul+t.add;isNaN(e)&&(e=0);for(var i=this.cells[0],n=0,s=i.length;s>n;++n)i[n]=e},v.changeWithValue.unremovable=!0,v.clone=function(t){var e=new t.constructor([]);return e._.ar=t._.ar,e._.mul=t._.mul,e._.add=t._.add,e._.bypassed=t._.bypassed,e},v.timer=function(t){var e=function(t){return function(){-1===o.timers.indexOf(t)&&(o.timers.push(t),o.events.emit("addObject"),t._.emit("start"),v.buddies_start(t))}}(t),i=function(t){return function(){var e=o.timers.indexOf(t);-1!==e&&(o.timers.splice(e,1),t._.emit("stop"),o.events.emit("removeObject"),v.buddies_stop(t))}}(t);return t.nodeType=S.TIMER,t.start=function(){return o.nextTick(e),t},t.stop=function(){return o.nextTick(i),t},t},v.listener=function(t){var e=function(t){return function(){-1===o.listeners.indexOf(t)&&(o.listeners.push(t),o.events.emit("addObject"),t._.emit("listen"),v.buddies_start(t))}}(t),i=function(t){return function(){var e=o.listeners.indexOf(t);-1!==e&&(o.listeners.splice(e,1),t._.emit("unlisten"),o.events.emit("removeObject"),v.buddies_stop(t))}}(t);return t.nodeType=S.LISTENER,t.listen=function(){return arguments.length&&t.append.apply(t,arguments),t.nodes.length&&o.nextTick(e),t},t.unlisten=function(){return arguments.length&&t.remove.apply(t,arguments),t.nodes.length||o.nextTick(i),t},t},v.make_onended=function(t,e){return function(){if(t.playbackState=0,"number"==typeof e)for(var i=t.cells[0],n=t.cells[1],s=t.cells[2],r=0,a=n.length;a>r;++r)i[0]=n[r]=s[r]=e;t._.emit("ended")}},v.inputSignalAR=function(t){var e,i,n,s,r,a,o=t.cells[0],u=t.cells[1],h=t.cells[2],l=t.nodes,c=l.length,f=o.length,p=t.tickID;if(2===t.numChannels){if(n=!0,0!==c){for(e=0;c>e;++e)if(1===l[e].playbackState){l[e].process(p),u.set(l[e].cells[1]),h.set(l[e].cells[2]),n=!1,++e;break}for(;c>e;++e)if(1===l[e].playbackState)for(l[e].process(p),r=l[e].cells[1],a=l[e].cells[2],i=f;i;)u[i-=8]+=r[i],h[i]+=a[i],u[i+1]+=r[i+1],h[i+1]+=a[i+1],u[i+2]+=r[i+2],h[i+2]+=a[i+2],u[i+3]+=r[i+3],h[i+3]+=a[i+3],u[i+4]+=r[i+4],h[i+4]+=a[i+4],u[i+5]+=r[i+5],h[i+5]+=a[i+5],u[i+6]+=r[i+6],h[i+6]+=a[i+6],u[i+7]+=r[i+7],h[i+7]+=a[i+7]}n&&(u.set(v.emptycell),h.set(v.emptycell))}else{if(n=!0,0!==c){for(e=0;c>e;++e)if(1===l[e].playbackState){l[e].process(p),o.set(l[e].cells[0]),n=!1,++e;break}for(;c>e;++e)if(1===l[e].playbackState)for(s=l[e].process(p).cells[0],i=f;i;)o[i-=8]+=s[i],o[i+1]+=s[i+1],o[i+2]+=s[i+2],o[i+3]+=s[i+3],o[i+4]+=s[i+4],o[i+5]+=s[i+5],o[i+6]+=s[i+6],o[i+7]+=s[i+7]}n&&o.set(v.emptycell)}},v.inputSignalKR=function(t){var e,i=t.nodes,n=i.length,s=t.tickID,r=0;for(e=0;n>e;++e)1===i[e].playbackState&&(r+=i[e].process(s).cells[0][0]);return r},v.outputSignalAR=function(t){var e,i=t.cells[0],n=t.cells[1],s=t.cells[2],r=t._.mul,a=t._.add;if(2===t.numChannels)for(e=i.length;e;)n[e-=8]=n[e]*r+a,s[e]=s[e]*r+a,n[e+1]=n[e+1]*r+a,s[e+1]=s[e+1]*r+a,n[e+2]=n[e+2]*r+a,s[e+2]=s[e+2]*r+a,n[e+3]=n[e+3]*r+a,s[e+3]=s[e+3]*r+a,n[e+4]=n[e+4]*r+a,s[e+4]=s[e+4]*r+a,n[e+5]=n[e+5]*r+a,s[e+5]=s[e+5]*r+a,n[e+6]=n[e+6]*r+a,s[e+6]=s[e+6]*r+a,n[e+7]=n[e+7]*r+a,s[e+7]=s[e+7]*r+a,i[e]=.5*(n[e]+s[e]),i[e+1]=.5*(n[e+1]+s[e+1]),i[e+2]=.5*(n[e+2]+s[e+2]),i[e+3]=.5*(n[e+3]+s[e+3]),i[e+4]=.5*(n[e+4]+s[e+4]),i[e+5]=.5*(n[e+5]+s[e+5]),i[e+6]=.5*(n[e+6]+s[e+6]),i[e+7]=.5*(n[e+7]+s[e+7]);else if(1!==r||0!==a)for(e=i.length;e;)i[e-=8]=i[e]*r+a,i[e+1]=i[e+1]*r+a,i[e+2]=i[e+2]*r+a,i[e+3]=i[e+3]*r+a,i[e+4]=i[e+4]*r+a,i[e+5]=i[e+5]*r+a,i[e+6]=i[e+6]*r+a,i[e+7]=i[e+7]*r+a},v.outputSignalKR=function(t){var e,i=t.cells[0],n=t.cells[1],s=t.cells[2],r=t._.mul,a=t._.add,o=i[0]*r+a;if(2===t.numChannels)for(e=i.length;e;)i[e-=8]=i[e+1]=i[e+2]=i[e+3]=i[e+4]=i[e+5]=i[e+6]=i[e+7]=n[e]=n[e+1]=n[e+2]=n[e+3]=n[e+4]=n[e+5]=n[e+6]=n[e+7]=s[e]=s[e+1]=s[e+2]=s[e+3]=s[e+4]=s[e+5]=s[e+6]=s[e+7]=o;else for(e=i.length;e;)i[e-=8]=i[e+1]=i[e+2]=i[e+3]=i[e+4]=i[e+5]=i[e+6]=i[e+7]=o},v.buddies_start=function(t){var e,i,n,s=t._.buddies;for(i=0,n=s.length;n>i;++i)switch(e=s[i],e.nodeType){case S.DSP:e.play();break;case S.TIMER:e.start();break;case S.LISTENER:e.listen()}},v.buddies_stop=function(t){var e,i,n,s=t._.buddies;for(i=0,n=s.length;n>i;++i)switch(e=s[i],e.nodeType){case S.DSP:e.pause();break;case S.TIMER:e.stop();break;case S.LISTENER:e.unlisten()}},v.fix_iOS6_1_problem=function(t){o.fix_iOS6_1_problem(t)};var _,y,w=n.modules={},k=w.EventEmitter=function(){function t(t){this.context=t,this.events={}}var e=t.prototype;return e.emit=function(t){var e,i=this.events[t];if(!i)return!1;if("function"==typeof i){switch(arguments.length){case 1:i.call(this.context);break;case 2:i.call(this.context,arguments[1]);break;case 3:i.call(this.context,arguments[1],arguments[2]);break;default:e=s.call(arguments,1),i.apply(this.context,e)}return!0}if(g(i)){e=s.call(arguments,1);for(var n=i.slice(),r=0,a=n.length;a>r;++r)n[r]instanceof S?n[r].bang.apply(n[r],e):n[r].apply(this.context,e);return!0}return i instanceof S&&(e=s.call(arguments,1),void i.bang.apply(i,e))},e.on=function(t,e){if("function"!=typeof e&&!(e instanceof S))throw new Error("addListener takes instances of Function or timbre.Object");var i=this.events;return i[t]?g(i[t])?i[t].push(e):i[t]=[i[t],e]:i[t]=e,this},e.once=function(t,e){var i,n=this;if("function"==typeof e)i=function(){n.off(t,i),e.apply(n.context,arguments)};else{if(!(e instanceof S))throw new Error("once takes instances of Function or timbre.Object");i=function(){n.off(t,i),e.bang.apply(e,arguments)}}return i.listener=e,n.on(t,i),this},e.off=function(t,e){if("function"!=typeof e&&!(e instanceof S))throw new Error("removeListener takes instances of Function or timbre.Object");var i=this.events;if(!i[t])return this;var n=i[t];if(g(n)){for(var s=-1,r=0,a=n.length;a>r;++r)if(n[r]===e||n[r].listener&&n[r].listener===e){s=r;break}if(0>s)return this;n.splice(s,1),0===n.length&&(i[t]=null)}else(n===e||n.listener&&n.listener===e)&&(i[t]=null);return this},e.removeAllListeners=function(t){var e=this.events,i=!1,n=e[t];if(g(n))for(var s=n.length;s--;){var r=n[s];r.unremovable?i=!0:this.off(t,r)}else n&&(n.unremovable?i=!0:this.off(t,n));return i||(e[t]=null),this},e.listeners=function(t){var e,i=this.events;if(!i[t])return[];if(i=i[t],!g(i))return i.unremovable?[]:[i];e=[];for(var n=0,s=(i=i.slice()).length;s>n;++n)i[n].unremovable||e.push(i[n]);return e},t}(),x=w.Deferred=function(){function t(t){this.context=t||this,this._state="pending",this._doneList=[],this._failList=[],this._promise=new e(this)}function e(t){this.context=t.context,this.then=t.then,this.done=function(){return t.done.apply(t,arguments),this},this.fail=function(){return t.fail.apply(t,arguments),this},this.pipe=function(){return t.pipe.apply(t,arguments)},this.always=function(){return t.always.apply(t,arguments),this},this.promise=function(){return this},this.isResolved=function(){return t.isResolved()},this.isRejected=function(){return t.isRejected()}}var i=t.prototype,n=function(t,e,i,n){if("pending"===this._state){this._state=t;for(var s=0,r=e.length;r>s;++s)e[s].apply(i,n);this._doneList=this._failList=null}},r=function(t){return t&&"function"==typeof t.promise};return i.resolve=function(){var t=s.call(arguments,0);return n.call(this,"resolved",this._doneList,this.context||this,t),this},i.resolveWith=function(t){var e=s.call(arguments,1);return n.call(this,"resolved",this._doneList,t,e),this},i.reject=function(){var t=s.call(arguments,0);return n.call(this,"rejected",this._failList,this.context||this,t),this},i.rejectWith=function(t){var e=s.call(arguments,1);return n.call(this,"rejected",this._failList,t,e),this},i.promise=function(){return this._promise},i.done=function(){for(var t=s.call(arguments),e="resolved"===this._state,i="pending"===this._state,n=this._doneList,r=0,a=t.length;a>r;++r)"function"==typeof t[r]&&(e?t[r]():i&&n.push(t[r]));return this},i.fail=function(){for(var t=s.call(arguments),e="rejected"===this._state,i="pending"===this._state,n=this._failList,r=0,a=t.length;a>r;++r)"function"==typeof t[r]&&(e?t[r]():i&&n.push(t[r]));return this},i.always=function(){return this.done.apply(this,arguments),this.fail.apply(this,arguments),this},i.then=function(t,e){return this.done(t).fail(e)},i.pipe=function(e,i){var n=this,a=new t(this.context);return this.done((function(){var t=e.apply(n.context,arguments);r(t)?t.then((function(){var e=s.call(arguments);a.resolveWith.apply(a,[t].concat(e))})):a.resolveWith(n,t)})),this.fail((function(){if("function"==typeof i){var t=i.apply(n.context,arguments);r(t)&&t.fail((function(){var e=s.call(arguments);a.rejectWith.apply(a,[t].concat(e))}))}else a.reject.apply(a,arguments)})),a.promise()},i.isResolved=function(){return"resolved"===this._state},i.isRejected=function(){return"rejected"===this._state},i.state=function(){return this._state},t.when=function(e){var i=0,n=s.call(arguments),a=n.length,o=a;1!==a||r(e)||(o=0);var u=1===o?e:new t,h=function(t,e){return function(i){e[t]=arguments.length>1?s.call(arguments):i,--o||u.resolve.apply(u,e)}};if(a>1)for(var l=new Array(a),c=function(){u.reject()};a>i;++i)n[i]&&r(n[i])?n[i].promise().done(h(i,l)).fail(c):(l[i]=n[i],--o);return o||u.resolve.apply(u,n),u.promise()},t}(),S=n.Object=function(){function t(e,i){this._={};var s=this._.events=new k(this);if(this._.emit=function(){return s.emit.apply(s,arguments)},b(i[0])){var r=i.shift(),a=r.in;this.once("init",(function(){this.set(r),a&&(g(a)?this.append.apply(this,a):a instanceof t&&this.append(a))}))}switch(this.tickID=-1,this.nodes=i.map(n),this.cells=[],this.numChannels=e,e){case 0:this.L=this.R=new A(null),this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 1:this.L=this.R=new A(this),this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 2:this.L=new A(this),this.R=new A(this),this.cells[0]=new v.SignalArray(o.cellsize),this.cells[1]=this.L.cell,this.cells[2]=this.R.cell}this.playbackState=1,this.nodeType=t.DSP,this._.ar=!0,this._.mul=1,this._.add=0,this._.dac=null,this._.bypassed=!1,this._.meta={},this._.samplerate=o.samplerate,this._.cellsize=o.cellsize,this._.buddies=[]}t.DSP=1,t.TIMER=2,t.LISTENER=3;var e=t.prototype;return Object.defineProperties(e,{isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},isBypassed:{get:function(){return this._.bypassed}},isEnded:{get:function(){return!(1&this.playbackState)}},mul:{set:function(t){"number"==typeof t&&(this._.mul=t,this._.emit("setMul",t))},get:function(){return this._.mul}},add:{set:function(t){"number"==typeof t&&(this._.add=t,this._.emit("setAdd",t))},get:function(){return this._.add}},buddies:{set:function(e){g(e)||(e=[e]),this._.buddies=e.filter((function(e){return e instanceof t}))},get:function(){return this._.buddies}}}),e.toString=function(){return this.constructor.name},e.valueOf=function(){return o.tickID!==this.tickID&&this.process(o.tickID),this.cells[0][0]},e.append=function(){if(arguments.length>0){var t=s.call(arguments).map(n);this.nodes=this.nodes.concat(t),this._.emit("append",t)}return this},e.appendTo=function(t){return t.append(this),this},e.remove=function(){if(arguments.length>0){for(var t,e=this.nodes,i=[],n=0,s=arguments.length;s>n;++n)-1!==(t=e.indexOf(arguments[n]))&&(i.push(e[t]),e.splice(t,1));i.length>0&&this._.emit("remove",i)}return this},e.removeFrom=function(t){return t.remove(this),this},e.removeAll=function(){var t=this.nodes.slice();return this.nodes=[],t.length>0&&this._.emit("remove",t),this},e.removeAtIndex=function(t){var e=this.nodes[t];return e&&(this.nodes.splice(t,1),this._.emit("remove",[e])),this},e.postMessage=function(t){return this._.emit("message",t),this},e.to=function(e){if(e instanceof t)e.append(this);else{var i=s.call(arguments);b(i[1])?i.splice(2,0,this):i.splice(1,0,this),e=d.apply(null,i)}return e},e.splice=function(e,i,n){var s;return i?i instanceof t&&(-1!==(s=i.nodes.indexOf(n))&&i.nodes.splice(s,1),e instanceof t?(e.nodes.push(this),i.nodes.push(e)):i.nodes.push(this)):this._.dac&&(e instanceof t?n instanceof t?n._.dac&&(n._.dac._.node=e,e._.dac=n._.dac,n._.dac=null,e.nodes.push(this)):this._.dac&&(this._.dac._.node=e,e._.dac=this._.dac,this._.dac=null,e.nodes.push(this)):n instanceof t&&n._.dac&&(n._.dac._.node=this,this._.dac=n._.dac,n._.dac=null)),this},e.on=e.addListener=function(t,e){return this._.events.on(t,e),this},e.once=function(t,e){return this._.events.once(t,e),this},e.off=e.removeListener=function(t,e){return this._.events.off(t,e),this},e.removeAllListeners=function(t){return this._.events.removeAllListeners(t),this},e.listeners=function(t){return this._.events.listeners(t)},e.set=function(t,e){var i,n,s=this._.meta;switch(typeof t){case"string":switch(s[t]){case"property":this[t]=e;break;case"function":this[t](e);break;default:for(i=this;null!==i;)(n=Object.getOwnPropertyDescriptor(i,t))&&("function"==typeof n.value?(s[t]="function",this[t](e)):(n.get||n.set)&&(s[t]="property",this[t]=e)),i=Object.getPrototypeOf(i)}break;case"object":for(i in t)this.set(i,t[i])}return this},e.get=function(t){return"property"===this._.meta[t]?this[t]:void 0},e.bang=function(){return this._.emit.apply(this,["bang"].concat(s.call(arguments))),this},e.process=v.nop,e.bypass=function(){return this._.bypassed=0===arguments.length||!!arguments[0],this},e.play=function(){var t=this._.dac;return null===t&&(t=this._.dac=new L(this)),t.play()&&this._.emit.apply(this,["play"].concat(s.call(arguments))),v.buddies_start(this),this},e.pause=function(){var t=this._.dac;return t&&1===t.playbackState&&(t.pause(),this._.dac=null,this._.emit("pause")),v.buddies_stop(this),this},e.start=e.stop=e.listen=e.unlisten=function(){return this},e.ar=function(){return 0===arguments.length||arguments[0]?this._.kronly||(this._.ar=!0,this._.emit("ar",!0)):this.kr(!0),this},e.kr=function(){return 0===arguments.length||arguments[0]?this._.aronly||(this._.ar=!1,this._.emit("ar",!1)):this.ar(!0),this},e.plot="browser"===l?function(t){var e=this._,n=t.target;if(!n)return this;var s,r,a=t.width||n.width||320,o=t.height||n.height||240,u=(t.x||0)+.5,h=t.y||0,l=n.getContext("2d");s=t.foreground!==i?t.foreground:e.plotForeground||"rgb(  0, 128, 255)",r=t.background!==i?t.background:e.plotBackground||"rgb(255, 255, 255)";var c,f,p,d,m,v=t.lineWidth||e.plotLineWidth||1,g=!!e.plotCyclic,b=e.plotData||this.cells[0],_=t.range||e.plotRange||[-1.2,1.2],y=_[0],w=o/(_[1]-y),k=a/b.length,x=b.length;if(l.save(),l.rect(u,h,a,o),null!==r&&(l.fillStyle=r,l.fillRect(u,h,a,o)),e.plotBefore&&e.plotBefore.call(this,l,u,h,a,o),e.plotBarStyle)for(l.fillStyle=s,c=0,m=0;x>m;++m)f=o-(p=(b[m]-y)*w),l.fillRect(c+u,f+h,k,p),c+=k;else{for(l.strokeStyle=s,l.lineWidth=v,l.beginPath(),c=0,d=o-(b[0]-y)*w,l.moveTo(c+u,d+h),m=1;x>m;++m)c+=k,f=o-(b[m]-y)*w,l.lineTo(c+u,f+h);g?l.lineTo(c+k+u,d+h):l.lineTo(c+k+u,f+h),l.stroke()}e.plotAfter&&e.plotAfter.call(this,l,u,h,a,o);var S=t.border||e.plotBorder;return S&&(l.strokeStyle="string"==typeof S?S:"#000",l.lineWidth=1,l.strokeRect(u,h,a,o)),l.restore(),this}:v.nop,t}(),A=n.ChannelObject=function(){function t(t){n.Object.call(this,-1,[]),v.fixAR(this),this._.parent=t,this.cell=new v.SignalArray(o.cellsize),this.L=this.R=this,this.cells[0]=this.cells[1]=this.cells[2]=this.cell,this.numChannels=1}return v.extend(t),t.prototype.process=function(t){return this.tickID!==t&&(this.tickID=t,this._.parent&&this._.parent.process(t)),this},t}(),I=function(){function t(t){S.call(this,2,t)}return v.extend(t),t.prototype.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.ar?(v.inputSignalAR(this),v.outputSignalAR(this)):(this.cells[0][0]=v.inputSignalKR(this),v.outputSignalKR(this))),this},v.register("+",t),t}(),T=function(){function t(t){if(S.call(this,1,[]),v.fixKR(this),this.value=t[0],b(t[1])){var e=t[1];this.once("init",(function(){this.set(e)}))}this.on("setAdd",v.changeWithValue),this.on("setMul",v.changeWithValue)}v.extend(t);var e=t.prototype;return Object.defineProperties(e,{value:{set:function(t){"number"==typeof t&&(this._.value=isNaN(t)?0:t,v.changeWithValue.call(this))},get:function(){return this._.value}}}),t}(),R=function(){function t(t){if(S.call(this,1,[]),v.fixKR(this),this.value=t[0],b(t[1])){var e=t[1];this.once("init",(function(){this.set(e)}))}this.on("setAdd",v.changeWithValue),this.on("setMul",v.changeWithValue)}v.extend(t);var e=t.prototype;return Object.defineProperties(e,{value:{set:function(t){this._.value=t?1:0,v.changeWithValue.call(this)},get:function(){return!!this._.value}}}),t}(),O=function(){function t(t){if(S.call(this,1,[]),v.fixKR(this),this.func=t[0],this._.value=0,b(t[1])){var e=t[1];this.once("init",(function(){this.set(e)}))}this.on("setAdd",v.changeWithValue),this.on("setMul",v.changeWithValue)}v.extend(t);var e=t.prototype;return Object.defineProperties(e,{func:{set:function(t){"function"==typeof t&&(this._.func=t)},get:function(){return this._.func}},args:{set:function(t){this._.args=g(t)?t:[t]},get:function(){return this._.args}}}),e.bang=function(){var t=this._,e=s.call(arguments).concat(t.args),i=t.func.apply(this,e);return"number"==typeof i&&(t.value=i,v.changeWithValue.call(this)),this._.emit("bang"),this},t}(),M=function(){function t(t){var e,i;for(S.call(this,1,[]),e=0,i=t[0].length;i>e;++e)this.append(t[0][e]);if(b(t[1])){var n=t[1];this.once("init",(function(){this.set(n)}))}}v.extend(t);var e=t.prototype;return Object.defineProperties(e,{}),e.bang=function(){var t,e,i=["bang"].concat(s.call(arguments)),n=this.nodes;for(t=0,e=n.length;e>t;++t)n[t].bang.apply(n[t],i);return this},e.postMessage=function(t){var e,i,n=this.nodes;for(e=0,i=n.length;i>e;++e)n[e].postMessage(t);return this},e.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.ar?(v.inputSignalAR(this),v.outputSignalAR(this)):(this.cells[0][0]=v.inputSignalKR(this),v.outputSignalKR(this))),this},t}(),D=function(){function t(t){if(S.call(this,1,[]),v.fixKR(this),b(t[1])){var e=t[1];this.once("init",(function(){this.set(e)}))}}v.extend(t);var e=t.prototype;return Object.defineProperties(e,{}),t}(),L=function(){function t(t){S.call(this,2,[]),this.playbackState=0;var n=this._;n.node=t,n.onplay=e(this),n.onpause=i(this)}v.extend(t);var e=function(t){return function(){-1===o.inlets.indexOf(t)&&(o.inlets.push(t),o.events.emit("addObject"),t.playbackState=1,t._.emit("play"))}},i=function(t){return function(){var e=o.inlets.indexOf(t);-1!==e&&(o.inlets.splice(e,1),t.playbackState=0,t._.emit("pause"),o.events.emit("removeObject"))}},n=t.prototype;return n.play=function(){return o.nextTick(this._.onplay),-1===o.inlets.indexOf(this)},n.pause=function(){o.nextTick(this._.onpause)},n.process=function(t){var e=this._.node;1&e.playbackState?(e.process(t),this.cells[1].set(e.cells[1]),this.cells[2].set(e.cells[2])):(this.cells[1].set(v.emptycell),this.cells[2].set(v.emptycell))},t}(),j=function(){function t(){this.context=this,this.tickID=0,this.impl=null,this.amp=.8,this.status=0,this.samplerate=44100,this.channels=2,this.cellsize=64,this.streammsec=20,this.streamsize=0,this.currentTime=0,this.nextTicks=[],this.inlets=[],this.timers=[],this.listeners=[],this.deferred=null,this.recStart=0,this.recBuffers=null,this.delayProcess=e(this),this.events=null,v.currentTimeIncr=1e3*this.cellsize/this.samplerate,v.emptycell=new v.SignalArray(this.cellsize),this.reset(!0)}var e=function(t){return function(){t.recStart=Date.now(),t.process()}},i=t.prototype;i.bind=function(t,e){if("function"==typeof t){var i=new t(this,e);this.impl=i,this.impl.defaultSamplerate&&(this.samplerate=this.impl.defaultSamplerate)}return this},i.setup=function(t){return"object"==typeof t&&(-1!==r.indexOf(t.samplerate)&&(this.samplerate=t.samplerate<=this.impl.maxSamplerate?t.samplerate:this.impl.maxSamplerate),-1!==a.indexOf(t.cellsize)&&(this.cellsize=t.cellsize),"undefined"!=typeof Float64Array&&void 0!==t.f64&&(f=!!t.f64,v.SignalArray=f?Float64Array:Float32Array)),v.currentTimeIncr=1e3*this.cellsize/this.samplerate,v.emptycell=new v.SignalArray(this.cellsize),this},i.getAdjustSamples=function(t){var e,i;return t=t||this.samplerate,e=this.streammsec/1e3*t,1<<(i=8>(i=Math.ceil(Math.log(e)*Math.LOG2E))?8:i>14?14:i)},i.play=function(){return 0===this.status&&(this.status=1,this.streamsize=this.getAdjustSamples(),this.strmL=new v.SignalArray(this.streamsize),this.strmR=new v.SignalArray(this.streamsize),this.impl.play(),this.events.emit("play")),this},i.pause=function(){return 1===this.status&&(this.status=0,this.impl.pause(),this.events.emit("pause")),this},i.reset=function(t){return t&&(this.events=new k(this).on("addObject",(function(){0===this.status&&this.play()})).on("removeObject",(function(){1===this.status&&this.inlets.length+this.timers.length+this.listeners.length===0&&this.pause()}))),this.currentTime=0,this.nextTicks=[],this.inlets=[],this.timers=[],this.listeners=[],this},i.process=function(){var t,e,i,n,s,r,a,o,u=this.tickID,h=this.strmL,l=this.strmR,c=this.amp,f=this.streamsize,p=0,d=this.cellsize,m=this.streamsize/this.cellsize,g=this.timers,b=this.inlets,_=this.listeners,y=v.currentTimeIncr;for(n=0;f>n;++n)h[n]=l[n]=0;for(;m--;){for(++u,s=0,r=g.length;r>s;++s)1&g[s].playbackState&&g[s].process(u);for(s=0,r=b.length;r>s;++s)if((t=b[s]).process(u),1&t.playbackState)for(e=t.cells[1],i=t.cells[2],a=0,n=p;d>a;++a,++n)h[n]+=e[a],l[n]+=i[a];for(p+=d,s=0,r=_.length;r>s;++s)1&_[s].playbackState&&_[s].process(u);for(this.currentTime+=y,s=0,r=(o=this.nextTicks.splice(0)).length;r>s;++s)o[s]()}for(n=0;f>n;++n)-1>(t=h[n]*c)?t=-1:t>1&&(t=1),h[n]=t,-1>(t=l[n]*c)?t=-1:t>1&&(t=1),l[n]=t;this.tickID=u;var w=this.currentTime;if(3===this.status){if(2===this.recCh)this.recBuffers.push(new v.SignalArray(h)),this.recBuffers.push(new v.SignalArray(l));else{var k=new v.SignalArray(h.length);for(n=0,f=k.length;f>n;++n)k[n]=.5*(h[n]+l[n]);this.recBuffers.push(k)}if(w>=this.maxDuration)this.deferred.sub.reject();else if(w>=this.recDuration)this.deferred.sub.resolve();else{Date.now()-this.recStart>20?setTimeout(this.delayProcess,10):this.process()}}},i.nextTick=function(t){0===this.status?t():this.nextTicks.push(t)},i.rec=function(){v.fix_iOS6_1_problem(!0);var t=new x(this);if(this.deferred)return console.warn("rec deferred is exists??"),t.reject().promise();if(0!==this.status)return console.log("status is not none",this.status),t.reject().promise();var e=0,i=arguments,r=b(i[e])?i[e++]:{},a=i[e];if("function"!=typeof a)return console.warn("no function"),t.reject().promise();this.deferred=t,this.status=3,this.reset();var o=new d("+"),u=new x(this),h={done:function(){u.resolve.apply(u,s.call(arguments))},send:function(){o.append.apply(o,arguments)}},l=this;return u.then(n,(function(){v.fix_iOS6_1_problem(!1),n.call(l,!0)})),this.deferred.sub=u,this.savedSamplerate=this.samplerate,this.samplerate=r.samplerate||this.samplerate,this.recDuration=r.recDuration||1/0,this.maxDuration=r.maxDuration||6e5,this.recCh=r.ch||1,2!==this.recCh&&(this.recCh=1),this.recBuffers=[],this.streamsize=this.getAdjustSamples(),this.strmL=new v.SignalArray(this.streamsize),this.strmR=new v.SignalArray(this.streamsize),this.inlets.push(o),a(h),setTimeout(this.delayProcess,10),t.promise()};var n=function(){this.status=0,this.reset();var t,e=this.recBuffers,i=this.samplerate,n=this.streamsize;this.samplerate=this.savedSamplerate;var s,r,a=(t=1/0!==this.recDuration?this.recDuration*i*.001|0:(e.length>>this.recCh-1)*n)/n|0,o=0,u=0,h=t;if(2===this.recCh){var l=new v.SignalArray(t),c=new v.SignalArray(t),f=new v.SignalArray(t);for(r=0;a>r;++r)if(l.set(e[o++],u),c.set(e[o++],u),u+=n,(h-=n)>0&&n>h){l.set(e[o++].subarray(0,h),u),c.set(e[o++].subarray(0,h),u);break}for(r=0,a=t;a>r;++r)f[r]=.5*(l[r]+c[r]);s={samplerate:i,channels:2,buffer:[f,l,c]}}else{var p=new v.SignalArray(t);for(r=0;a>r;++r)if(p.set(e[o++],u),u+=n,(h-=n)>0&&n>h){p.set(e[o++].subarray(0,h),u);break}s={samplerate:i,channels:1,buffer:[p]}}var d=[].concat.apply([s],arguments);this.deferred.resolve.apply(this.deferred,d),this.deferred=null};return i.on=function(t,e){this.events.on(t,e)},i.once=function(t,e){this.events.once(t,e)},i.off=function(t,e){this.events.off(t,e)},i.removeAllListeners=function(t){this.events.removeListeners(t)},i.listeners=function(t){return this.events.listeners(t)},i.fix_iOS6_1_problem=function(t){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(t)},t}();"undefined"!=typeof window&&(_=window.AudioContext||window.webkitAudioContext),y=void 0!==_?function(t){var e,i,n=new _;v._audioContext=n,this.maxSamplerate=n.sampleRate,this.defaultSamplerate=n.sampleRate,this.env="webkit";var s=navigator.userAgent;if(s.match(/linux/i)?t.streammsec*=8:s.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&(t.streammsec*=4),this.play=function(){var s,r,a,o=t.getAdjustSamples(n.sampleRate),u=t.streamsize;t.samplerate===n.sampleRate?s=function(e){var i=e.outputBuffer;t.process(),i.getChannelData(0).set(t.strmL),i.getChannelData(1).set(t.strmR)}:2*t.samplerate===n.sampleRate?s=function(e){var i,n,s=t.strmL,r=t.strmR,a=e.outputBuffer,o=a.getChannelData(0),u=a.getChannelData(1),h=a.length;for(t.process(),i=n=0;h>i;i+=2,++n)o[i]=o[i+1]=s[n],u[i]=u[i+1]=r[n]}:(r=u,a=t.samplerate/n.sampleRate,s=function(e){var i,n=t.strmL,s=t.strmR,o=e.outputBuffer,h=o.getChannelData(0),l=o.getChannelData(1),c=o.length;for(i=0;c>i;++i)r>=u&&(t.process(),r-=u),h[i]=n[0|r],l[i]=s[0|r],r+=a}),e=n.createBufferSource(),(i=n.createScriptProcessor(o,2,t.channels)).onaudioprocess=s,e.noteOn&&e.noteOn(0),e.connect(i),i.connect(n.destination)},this.pause=function(){e.disconnect(),i.disconnect()},c){var r=0,a=n.createBufferSource();this.fix_iOS6_1_problem=function(t){1===(r+=t?1:-1)?(a.noteOn(0),a.connect(n.destination)):0===r&&a.disconnect()}}}:function(){this.maxSamplerate=48e3,this.defaultSamplerate=44100,this.env="nop",this.play=function(){},this.pause=function(){}},o=(new j).bind(y);var P=n;"node"===l||t.exports?t.exports=e.timbre=P:"browser"===l&&(P.noConflict=function(){var t=window.timbre,e=window.T;return function(i){return window.T===P&&(window.T=e),i&&window.timbre===P&&(window.timbre=t),P}}(),window.timbre=window.T=P),function(){if("nop"===o.impl.env&&"browser"===l&&!c){var t=navigator;if(!(function(e){try{return t.plugins&&t.mimeTypes&&t.mimeTypes.length?t.plugins["Shockwave Flash"].description.match(/([0-9]+)/)[e]:new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").match(/([0-9]+)/)[e]}catch(t){return-1}}(0)<10)){var e,i=function(){var t=document.getElementsByTagName("script");if(t&&t.length)for(var e,i=0,n=t.length;n>i;++i)if(e=/^(.*\/)timbre(?:\.dev)?\.js$/i.exec(t[i].src))return e[1]+"timbre.swf"}();window.timbrejs_flashfallback_init=function(){o.bind((function(t){var n=0;this.maxSamplerate=44100,this.defaultSamplerate=44100,this.env="flash",this.play=function(){var s,r=new Array(t.streamsize*t.channels),a=t.streammsec,o=0,u=t.streamsize/t.samplerate*1e3,h=Date.now();s=function(){if(!(o>Date.now()-h)){var i=t.strmL,n=t.strmR,s=r.length,a=i.length;for(t.process();a--;)r[--s]=32768*n[a]|0,r[--s]=32768*i[a]|0;e.writeAudio(r.join(" ")),o+=u}},e.setup?(e.setup(t.channels,t.samplerate),n=setInterval(s,a)):console.warn("Cannot find "+i)},this.pause=function(){0!==n&&(e.cancel(),clearInterval(n),n=0)}})),delete window.timbrejs_flashfallback_init};var n,s,r=i+"?"+ +new Date,a="TimbreFlashPlayer",u=document.createElement("div");u.id="TimbreFlashPlayerDiv",u.style.display="inline",u.width=u.height=1,t.plugins&&t.mimeTypes&&t.mimeTypes.length?((n=document.createElement("object")).id=a,n.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",n.width=n.height=1,n.setAttribute("data",r),n.setAttribute("type","application/x-shockwave-flash"),(s=document.createElement("param")).setAttribute("name","allowScriptAccess"),s.setAttribute("value","always"),n.appendChild(s),u.appendChild(n)):u.innerHTML='<object id="'+a+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1"><param name="movie" value="'+r+'" /><param name="bgcolor" value="#FFFFFF" /><param name="quality" value="high" /><param name="allowScriptAccess" value="always" /></object>',window.addEventListener("load",(function(){document.body.appendChild(u),e=document[a]}))}}}()}(),function(t){"use strict";function e(t){this.samplerate=t,this.frequency=340,this.Q=1,this.gain=0,this.x1L=this.x2L=this.y1L=this.y2L=0,this.x1R=this.x2R=this.y1R=this.y2R=0,this.b0=this.b1=this.b2=this.a1=this.a2=0,this.setType("lpf")}var i=e.prototype;i.process=function(t,e){var i,n,s,r,a,o,u=this.x1L,h=this.x2L,l=this.y1L,c=this.y2L,f=this.x1R,p=this.x2R,d=this.y1R,m=this.y2R,v=this.b0,g=this.b1,b=this.b2,_=this.a1,y=this.a2;for(a=0,o=t.length;o>a;++a)s=v*(i=t[a])+g*u+b*h-_*l-y*c,h=u,u=i,c=l,l=s,r=v*(n=e[a])+g*f+b*p-_*d-y*m,p=f,f=n,m=d,d=r,t[a]=s,e[a]=r;this.x1L=u,this.x2L=h,this.y1L=l,this.y2L=c,this.x1R=f,this.x2R=p,this.y1R=d,this.y2R=m},i.setType=function(t){var e;(e=n[t])&&(this.type=t,e.call(this,this.frequency,this.Q,this.gain))},i.setParams=function(t,e,i){this.frequency=t,this.Q=e,this.gain=i;var s=n[this.type];return s&&s.call(this,t,e,i),this};var n={lowpass:function(t,e){if((t/=.5*this.samplerate)>=1)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=t)this.b0=this.b1=this.b2=this.a1=this.a2=0;else{e=0>e?0:e;var i=Math.pow(10,.05*e),n=Math.sqrt(.5*(4-Math.sqrt(16-16/(i*i)))),s=Math.PI*t,r=.5*n*Math.sin(s),a=.5*(1-r)/(1+r),o=(.5+a)*Math.cos(s),u=.25*(.5+a-o);this.b0=2*u,this.b1=4*u,this.b2=this.b0,this.a1=2*-o,this.a2=2*a}},highpass:function(t,e){if((t/=.5*this.samplerate)>=1)this.b0=this.b1=this.b2=this.a1=this.a2=0;else if(0>=t)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{e=0>e?0:e;var i=Math.pow(10,.05*e),n=Math.sqrt((4-Math.sqrt(16-16/(i*i)))/2),s=Math.PI*t,r=.5*n*Math.sin(s),a=.5*(1-r)/(1+r),o=(.5+a)*Math.cos(s),u=.25*(.5+a+o);this.b0=2*u,this.b1=-4*u,this.b2=this.b0,this.a1=2*-o,this.a2=2*a}},bandpass:function(t,e){if((t/=.5*this.samplerate)>0&&1>t)if(e>0){var i=Math.PI*t,n=Math.sin(i)/(2*e),s=Math.cos(i),r=1/(1+n);this.b0=n*r,this.b1=0,this.b2=-n*r,this.a1=-2*s*r,this.a2=(1-n)*r}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(t,e,i){t/=.5*this.samplerate;var n=Math.pow(10,i/40);if(t>=1)this.b0=n*n,this.b1=this.b2=this.a1=this.a2=0;else if(0>=t)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else{var s=Math.PI*t,r=.5*Math.sin(s)*Math.sqrt(0*(n+1/n)+2),a=Math.cos(s),o=2*Math.sqrt(n)*r,u=n+1,h=n-1,l=1/(u+h*a+o);this.b0=n*(u-h*a+o)*l,this.b1=2*n*(h-u*a)*l,this.b2=n*(u-h*a-o)*l,this.a1=-2*(h+u*a)*l,this.a2=(u+h*a-o)*l}},highshelf:function(t,e,i){t/=.5*this.samplerate;var n=Math.pow(10,i/40);if(t>=1)this.b0=1,this.b1=this.b2=this.a1=this.a2=0;else if(0>=t)this.b0=n*n,this.b1=this.b2=this.a1=this.a2=0;else{var s=Math.PI*t,r=.5*Math.sin(s)*Math.sqrt(0*(n+1/n)+2),a=Math.cos(s),o=2*Math.sqrt(n)*r,u=n+1,h=n-1,l=1/(u-h*a+o);this.b0=n*(u+h*a+o)*l,this.b1=-2*n*(h+u*a)*l,this.b2=n*(u+h*a-o)*l,this.a1=2*(h-u*a)*l,this.a2=(u-h*a-o)*l}},peaking:function(t,e,i){if((t/=.5*this.samplerate)>0&&1>t){var n=Math.pow(10,i/40);if(e>0){var s=Math.PI*t,r=Math.sin(s)/(2*e),a=Math.cos(s),o=1/(1+r/n);this.b0=(1+r*n)*o,this.b1=-2*a*o,this.b2=(1-r*n)*o,this.a1=this.b1,this.a2=(1-r/n)*o}else this.b0=n*n,this.b1=this.b2=this.a1=this.a2=0}else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},notch:function(t,e){if((t/=.5*this.samplerate)>0&&1>t)if(e>0){var i=Math.PI*t,n=Math.sin(i)/(2*e),s=Math.cos(i),r=1/(1+n);this.b0=r,this.b1=-2*s*r,this.b2=r,this.a1=this.b1,this.a2=(1-n)*r}else this.b0=this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0},allpass:function(t,e){if((t/=.5*this.samplerate)>0&&1>t)if(e>0){var i=Math.PI*t,n=Math.sin(i)/(2*e),s=Math.cos(i),r=1/(1+n);this.b0=(1-n)*r,this.b1=-2*s*r,this.b2=(1+n)*r,this.a1=this.b1,this.a2=this.b0}else this.b0=-1,this.b1=this.b2=this.a1=this.a2=0;else this.b0=1,this.b1=this.b2=this.a1=this.a2=0}};n.lpf=n.lowpass,n.hpf=n.highpass,n.bpf=n.bandpass,n.bef=n.notch,n.brf=n.notch,n.apf=n.allpass,t.modules.Biquad=e}(timbre),function(t){"use strict";function e(e){this.samplerate=e;var i=Math.round(Math.log(.1*e)*Math.LOG2E);this.buffersize=1<<i,this.bufferL=new t.fn.SignalArray(this.buffersize+1),this.bufferR=new t.fn.SignalArray(this.buffersize+1),this.wave=null,this._wave=null,this.writeIndex=this.buffersize>>1,this.readIndex=0,this.delayTime=20,this.rate=4,this.depth=20,this.feedback=.2,this.wet=.5,this.phase=0,this.phaseIncr=0,this.phaseStep=4,this.setWaveType("sin"),this.setDelayTime(this.delayTime),this.setRate(this.rate)}var i=e.prototype,n=[];n[0]=function(){for(var t=new Float32Array(512),e=0;512>e;++e)t[e]=Math.sin(2*Math.PI*(e/512));return t}(),n[1]=function(){for(var t,e=new Float32Array(512),i=0;512>i;++i)t=i/512-.25,e[i]=1-4*Math.abs(Math.round(t)-t);return e}(),i.setWaveType=function(t){"sin"===t?(this.wave=t,this._wave=n[0]):"tri"===t&&(this.wave=t,this._wave=n[1])},i.setDelayTime=function(t){this.delayTime=t;for(var e=this.writeIndex-(t*this.samplerate*.001|0);0>e;)e+=this.buffersize;this.readIndex=e},i.setRate=function(t){this.rate=t,this.phaseIncr=512*this.rate/this.samplerate*this.phaseStep},i.process=function(t,e){var i,n,s,r,a,o=this.bufferL,u=this.bufferR,h=this.buffersize,l=h-1,c=this._wave,f=this.phase,p=this.phaseIncr,d=this.writeIndex,m=this.readIndex,v=this.depth,g=this.feedback,b=this.wet,_=1-b,y=t.length,w=this.phaseStep;for(r=0;y>r;){for(s=c[0|f]*v,f+=p;f>512;)f-=512;for(a=0;w>a;++a,++r)i=.5*(o[n=m+h+s&l]+o[n+1]),o[d]=t[r]-i*g,t[r]=t[r]*_+i*b,i=.5*(u[n]+u[n+1]),u[d]=e[r]-i*g,e[r]=e[r]*_+i*b,d=d+1&l,m=m+1&l}this.phase=f,this.writeIndex=d,this.readIndex=m},t.modules.Chorus=e}(timbre),function(t){"use strict";function e(e,n){this.samplerate=e,this.channels=n,this.lastPreDelayFrames=0,this.preDelayReadIndex=0,this.preDelayWriteIndex=s,this.ratio=-1,this.slope=-1,this.linearThreshold=-1,this.dbThreshold=-1,this.dbKnee=-1,this.kneeThreshold=-1,this.kneeThresholdDb=-1,this.ykneeThresholdDb=-1,this.K=-1,this.attackTime=.003,this.releaseTime=.25,this.preDelayTime=.006,this.dbPostGain=0,this.effectBlend=1,this.releaseZone1=.09,this.releaseZone2=.16,this.releaseZone3=.42,this.releaseZone4=.98,this.detectorAverage=0,this.compressorGain=1,this.meteringGain=1,this.delayBufferL=new t.fn.SignalArray(i),this.delayBufferR=2===n?new t.fn.SignalArray(i):this.delayBufferL,this.preDelayTime=6,this.preDelayReadIndex=0,this.preDelayWriteIndex=s,this.maxAttackCompressionDiffDb=-1,this.meteringReleaseK=1-Math.exp(-1/(.325*this.samplerate)),this.setAttackTime(this.attackTime),this.setReleaseTime(this.releaseTime),this.setPreDelayTime(this.preDelayTime),this.setParams(-24,30,12)}var i=1024,n=i-1,s=256,r=e.prototype;r.clone=function(){var t=new e(this.samplerate,this.channels);return t.setAttackTime(this.attackTime),t.setReleaseTime(this.releaseTime),t.setPreDelayTime(this.preDelayTime),t.setParams(this.dbThreshold,this.dbKnee,this.ratio),t},r.setAttackTime=function(t){this.attackTime=Math.max(.001,t),this._attackFrames=this.attackTime*this.samplerate},r.setReleaseTime=function(t){this.releaseTime=Math.max(.001,t);var e=this.releaseTime*this.samplerate;this._satReleaseFrames=.0025*this.samplerate;var i=e*this.releaseZone1,n=e*this.releaseZone2,s=e*this.releaseZone3,r=e*this.releaseZone4;this._kA=.9999999999999998*i+18432219684323923e-32*n-19373394351676423e-32*s+8824516011816245e-33*r,this._kB=-1.5788320352845888*i+2.3305837032074286*n-.9141194204840429*s+.1623677525612032*r,this._kC=.5334142869106424*i-1.272736789213631*n+.9258856042207512*s-.18656310191776226*r,this._kD=.08783463138207234*i-.1694162967925622*n+.08588057951595272*s-.00429891410546283*r,this._kE=-.042416883008123074*i+.1115693827987602*n-.09764676325265872*s+.028494263462021576*r},r.setPreDelayTime=function(t){this.preDelayTime=t;var e=t*this.samplerate;if(e>i-1&&(e=i-1),this.lastPreDelayFrames!==e){this.lastPreDelayFrames=e;for(var n=0,s=this.delayBufferL.length;s>n;++n)this.delayBufferL[n]=this.delayBufferR[n]=0;this.preDelayReadIndex=0,this.preDelayWriteIndex=e}},r.setParams=function(t,e,i){this._k=this.updateStaticCurveParameters(t,e,i);var n=1/this.saturate(1,this._k);n=Math.pow(n,.6),this._masterLinearGain=Math.pow(10,.05*this.dbPostGain)*n},r.kneeCurve=function(t,e){return t<this.linearThreshold?t:this.linearThreshold+(1-Math.exp(-e*(t-this.linearThreshold)))/e},r.saturate=function(t,e){var i;if(t<this.kneeThreshold)i=this.kneeCurve(t,e);else{var n=t?20*Math.log(t)*Math.LOG10E:-1e3,s=this.ykneeThresholdDb+this.slope*(n-this.kneeThresholdDb);i=Math.pow(10,.05*s)}return i},r.slopeAt=function(t,e){if(t<this.linearThreshold)return 1;var i=1.001*t,n=t?20*Math.log(t)*Math.LOG10E:-1e3,s=i?20*Math.log(i)*Math.LOG10E:-1e3,r=this.kneeCurve(t,e),a=this.kneeCurve(i,e),o=r?20*Math.log(r)*Math.LOG10E:-1e3;return((a?20*Math.log(a)*Math.LOG10E:-1e3)-o)/(s-n)},r.kAtSlope=function(t){for(var e=this.dbThreshold+this.dbKnee,i=Math.pow(10,.05*e),n=.1,s=1e4,r=5,a=0;15>a;++a){t>this.slopeAt(i,r)?s=r:n=r,r=Math.sqrt(n*s)}return r},r.updateStaticCurveParameters=function(t,e,i){this.dbThreshold=t,this.linearThreshold=Math.pow(10,.05*t),this.dbKnee=e,this.ratio=i,this.slope=1/this.ratio,this.kneeThresholdDb=t+e,this.kneeThreshold=Math.pow(10,.05*this.kneeThresholdDb);var n=this.kAtSlope(1/this.ratio),s=this.kneeCurve(this.kneeThreshold,n);return this.ykneeThresholdDb=s?20*Math.log(s)*Math.LOG10E:-1e3,this._k=n,this._k},r.process=function(t,e){for(var i=1-this.effectBlend,s=this.effectBlend,r=this._k,a=this._masterLinearGain,o=this._satReleaseFrames,u=this._kA,h=this._kB,l=this._kC,c=this._kD,f=this._kE,p=t.length/64,d=0,m=this.detectorAverage,v=this.compressorGain,g=this.maxAttackCompressionDiffDb,b=1/this._attackFrames,_=this.preDelayReadIndex,y=this.preDelayWriteIndex,w=this.detectorAverage,k=this.delayBufferL,x=this.delayBufferR,S=this.meteringGain,A=this.meteringReleaseK,I=0;p>I;++I){var T,R=Math.asin(m)/(.5*Math.PI),O=R>v,M=v/R,D=M?20*Math.log(M)*Math.LOG10E:-1e3;if((1/0===D||isNaN(D))&&(D=-1),O){g=-1;var L=(M=-12>(M=D)?0:M>0?3:.25*(M+12))*M,j=5/(u+h*M+l*L+c*(L*M)+f*(L*L));T=Math.pow(10,.05*j)}else{(-1===g||D>g)&&(g=D),M=.25/Math.max(.5,g),T=1-Math.pow(M,b)}for(var P=64;P--;){var E=0,F=.5*(t[d]+e[d]);k[y]=t[d],x[y]=e[d],0>F&&(F*=-1),F>E&&(E=F);var B=E;0>B&&(B*=-1);var q=this.saturate(B,r),C=1e-4>=B?1:q/B,N=C?-20*Math.log(C)*Math.LOG10E:1e3;2>N&&(N=2);var z=N/o,G=Math.pow(10,.05*z)-1;(w+=(C-w)*(C>w?G:1))>1&&(w=1),1>T?v+=(R-v)*T:(v*=T)>1&&(v=1);var W=Math.sin(.5*Math.PI*v),K=i+s*a*W,V=20*Math.log(W)*Math.LOG10E;S>V?S=V:S+=(V-S)*A,t[d]=k[_]*K,e[d]=x[_]*K,d++,_=_+1&n,y=y+1&n}1e-6>w&&(w=1e-6),1e-6>v&&(v=1e-6)}this.preDelayReadIndex=_,this.preDelayWriteIndex=y,this.detectorAverage=w,this.compressorGain=v,this.maxAttackCompressionDiffDb=g,this.meteringGain=S},r.reset=function(){this.detectorAverage=0,this.compressorGain=1,this.meteringGain=1;for(var t=0,e=this.delayBufferL.length;e>t;++t)this.delayBufferL[t]=this.delayBufferR[t]=0;this.preDelayReadIndex=0,this.preDelayWriteIndex=s,this.maxAttackCompressionDiffDb=-1},t.modules.Compressor=e}(timbre),function(t){"use strict";function e(){}e.prototype.decode=function(t,i,n){if("string"==typeof t){if(/\.wav$/.test(t))return e.wav_decode(t,i,n);if(e.ogg_decode&&/\.ogg$/.test(t))return e.ogg_decode(t,i,n);if(e.mp3_decode&&/\.mp3$/.test(t))return e.mp3_decode(t,i,n)}else if("object"==typeof t){if("wav"===t.type)return e.wav_decode(t.data,i,n);if(e.ogg_decode&&"ogg"===t.type)return e.ogg_decode(t.data,i,n);if(e.mp3_decode&&"mp3"===t.type)return e.mp3_decode(t.data,i,n)}return e.webkit_decode?"object"==typeof t?e.webkit_decode(t.data||t,i,n):e.webkit_decode(t,i,n):e.moz_decode?e.moz_decode(t,i,n):void i(!1)},t.modules.Decoder=e,e.getBinaryWithPath="browser"===t.envtype?function(e,i){t.fn.fix_iOS6_1_problem(!0);var n=new XMLHttpRequest;n.open("GET",e),n.responseType="arraybuffer",n.onreadystatechange=function(){4===n.readyState&&(n.response?i(new Uint8Array(n.response)):void 0!==n.responseBody&&i(new Uint8Array(VBArray(n.responseBody).toArray())),t.fn.fix_iOS6_1_problem(!1))},n.send()}:function(t,e){e("no support")};e.wav_decode=function(){var t=function(t,e,i){if("RIFF"!==String.fromCharCode(t[0],t[1],t[2],t[3]))return e(!1);if(t[4]+(t[5]<<8)+(t[6]<<16)+(t[7]<<24)+8!==t.length)return e(!1);if("WAVE"!==String.fromCharCode(t[8],t[9],t[10],t[11]))return e(!1);if("fmt "!==String.fromCharCode(t[12],t[13],t[14],t[15]))return e(!1);for(var n=t[22]+(t[23]<<8),s=t[24]+(t[25]<<8)+(t[26]<<16)+(t[27]<<24),r=t[34]+(t[35]<<8),a=36;a<t.length&&"data"!==String.fromCharCode(t[a],t[a+1],t[a+2],t[a+3]);)a+=1;if(a>=t.length)return e(!1);var o,u,h,l=t[a+=4]+(t[a+1]<<8)+(t[a+2]<<16)+(t[a+3]<<24),c=(l/n>>1)/s;if(a+=4,l>t.length-a)return e(!1);o=new Float32Array(c*s|0),2===n&&(u=new Float32Array(o.length),h=new Float32Array(o.length)),e({samplerate:s,channels:n,buffer:[o,u,h],duration:c}),8===r?t=new Int8Array(t.buffer,a):16===r?t=new Int16Array(t.buffer,a):32===r?t=new Int32Array(t.buffer,a):24===r&&(t=function(t){for(var e,i,n=new Int32Array(t.length/3),s=0,r=t.length,a=0;r>s;)i=8388608&(e=t[s++]+(t[s++]<<8)+(t[s++]<<16))?e-16777216:e,n[a++]=i;return n}(new Uint8Array(t.buffer,a)));var f,p,d,m=1/((1<<r-1)-1);if(2===n)for(a=p=0,f=o.length;f>a;++a)d=u[a]=t[p++]*m,d+=h[a]=t[p++]*m,o[a]=.5*d;else for(a=0,f=o.length;f>a;++a)o[a]=t[a]*m;i()};return function(i,n,s){"string"==typeof i?e.getBinaryWithPath(i,(function(e){t(e,n,s)})):t(i,n,s)}}(),e.webkit_decode=function(){if(void 0!==t.fn._audioContext){var i=t.fn._audioContext,n=function(t,e,n){var s,r,a,o,u,h;if("string"==typeof t)return n(!1);try{h=i.createBuffer(t.buffer,!1)}catch(t){return e(!1)}s=i.sampleRate,2===(r=h.numberOfChannels)?(a=h.getChannelData(0),o=h.getChannelData(1)):a=o=h.getChannelData(0),u=a.length/s;for(var l=new Float32Array(a),c=0,f=l.length;f>c;++c)l[c]=.5*(l[c]+o[c]);e({samplerate:s,channels:r,buffer:[l,a,o],duration:u}),n()};return function(t,i,s){if(t instanceof File){var r=new FileReader;r.onload=function(t){n(new Uint8Array(t.target.result),i,s)},r.readAsArrayBuffer(t)}else"string"==typeof t?e.getBinaryWithPath(t,(function(t){n(t,i,s)})):n(t,i,s)}}}(),e.moz_decode="function"==typeof Audio&&"function"==typeof(new Audio).mozSetup?function(t,e,i){var n,s,r,a,o,u,h=0,l=new Audio(t);l.volume=0,l.addEventListener("loadedmetadata",(function(){n=l.mozSampleRate,s=l.mozChannels,u=l.duration,r=new Float32Array(l.duration*n|0),2===s&&(a=new Float32Array(l.duration*n|0),o=new Float32Array(l.duration*n|0)),2===s?l.addEventListener("MozAudioAvailable",(function(t){for(var e,i=t.frameBuffer,n=0,s=i.length;s>n;n+=2)e=a[h]=i[n],e+=o[h]=i[n+1],r[h]=.5*e,h+=1}),!1):l.addEventListener("MozAudioAvailable",(function(t){for(var e=t.frameBuffer,i=0,n=e.length;n>i;++i)r[i]=e[i],h+=1}),!1),l.play(),setTimeout((function(){e({samplerate:n,channels:s,buffer:[r,a,o],duration:u})}),1e3)}),!1),l.addEventListener("ended",(function(){i()}),!1),l.load()}:void 0}(timbre),function(t){"use strict";function e(t){this.samplerate=t||44100,this.value=n,this.status=f,this.curve="linear",this.step=1,this.releaseNode=null,this.loopNode=null,this.emit=null,this._envValue=new i(t),this._table=[],this._initValue=n,this._curveValue=0,this._defaultCurveType=r,this._index=0,this._counter=0}function i(t){this.samplerate=t,this.value=n,this.step=1,this._curveType=r,this._curveValue=0,this._grow=0,this._a2=0,this._b1=0,this._y1=0,this._y2=0}var n=e.ZERO=1e-6,s=e.CurveTypeSet=0,r=e.CurveTypeLin=1,a=e.CurveTypeExp=2,o=e.CurveTypeSin=3,u=e.CurveTypeWel=4,h=e.CurveTypeCurve=5,l=e.CurveTypeSqr=6,c=e.CurveTypeCub=7,f=e.StatusWait=0,p=e.StatusGate=1,d=e.StatusSustain=2,m=e.StatusRelease=3,v=e.StatusEnd=4,g={set:s,lin:r,linear:r,exp:a,exponential:a,sin:o,sine:o,wel:u,welch:u,sqr:l,squared:l,cub:c,cubed:c};e.CurveTypeDict=g;var b=e.prototype;b.clone=function(){var t=new e(this.samplerate);return t._table=this._table,t._initValue=this._initValue,t.setCurve(this.curve),null!==this.releaseNode&&t.setReleaseNode(this.releaseNode+1),null!==this.loopNode&&t.setLoopNode(this.loopNode+1),t.setStep(this.step),t.reset(),t},b.setTable=function(t){this._initValue=t[0],this._table=t.slice(1),this.value=this._envValue.value=this._initValue,this._index=0,this._counter=0,this.status=f},b.setCurve=function(t){"number"==typeof t?(this._defaultCurveType=h,this._curveValue=t,this.curve=t):(this._defaultCurveType=g[t]||null,this.curve=t)},b.setReleaseNode=function(t){"number"==typeof t&&t>0&&(this.releaseNode=t-1)},b.setLoopNode=function(t){"number"==typeof t&&t>0&&(this.loopNode=t-1)},b.setStep=function(t){this.step=this._envValue.step=t},b.reset=function(){this.value=this._envValue.value=this._initValue,this._index=0,this._counter=0,this.status=f},b.release=function(){null!==this.releaseNode&&this._index<=this.releaseNode&&(this._counter=0,this._index=this.releaseNode,this.status=m)},b.getInfo=function(t){var e,i,n=this._table,s=0,r=1/0,a=1/0,o=!1;for(e=0,i=n.length;i>e;++e){this.loopNode===e&&(r=s),this.releaseNode===e&&(t>s?s+=t:s=t,a=s);var u=n[e];Array.isArray(u)&&(s+=u[1])}return 1/0!==r&&1/0===a&&(s+=t,o=!0),{totalDuration:s,loopBeginTime:r,releaseBeginTime:a,isEndlessLoop:o}},b.calcStatus=function(){var t,e,i,n,a=this.status,o=this._table,u=this._index,l=this._counter,c=this._curveValue,g=this._defaultCurveType,b=this.loopNode,_=this.releaseNode,y=this._envValue,w=null;switch(a){case f:case v:break;case p:case m:for(;0>=l;)if(u>=o.length){if(a===p&&null!==b){u=b;continue}a=v,l=1/0,n=s,w="ended"}else if(a!==p||u!==_)e=(t=o[u++])[0],(n=null===t[2]?g:t[2])===h&&(c=t[3],Math.abs(c)<.001&&(n=r)),i=t[1],l=y.setNext(e,i,n,c);else{if(null!==b&&_>b){u=b;continue}a=d,l=1/0,n=s,w="sustained"}}return this.status=a,this.emit=w,this._index=u,this._counter=l,a},b.next=function(){return 1&this.calcStatus()&&(this.value=this._envValue.next()||n),this._counter-=1,this.value},b.process=function(t){var e,i=this._envValue,s=t.length;if(1&this.calcStatus())for(e=0;s>e;++e)t[e]=i.next()||n;else{var r=this.value||n;for(e=0;s>e;++e)t[e]=r}this.value=t[s-1],this._counter-=t.length},i.prototype.setNext=function(t,e,i,n){var f,p,d,m,v,g,b,y=this.step,w=this.value,k=.001*e*this.samplerate/y|0;switch(1>k&&(k=1,i=s),i){case s:this.value=t;break;case r:f=(t-w)/k;break;case a:f=0!==w?Math.pow(t/w,1/k):0;break;case o:p=Math.PI/k,m=.5*(t+w),v=2*Math.cos(p),b=(g=.5*(t-w))*Math.sin(.5*Math.PI-p),w=m-g;break;case u:p=.5*Math.PI/k,v=2*Math.cos(p),t>=w?(m=w,g=0,b=-Math.sin(p)*(t-w)):(m=t,g=w-t,b=Math.cos(p)*(w-t)),w=m+g;break;case h:m=w+(d=(t-w)/(1-Math.exp(n))),v=d,f=Math.exp(n/k);break;case l:g=Math.sqrt(w),f=((b=Math.sqrt(t))-g)/k;break;case c:g=Math.pow(w,.33333333),f=((b=Math.pow(t,.33333333))-g)/k}return this.next=_[i],this._grow=f,this._a2=m,this._b1=v,this._y1=g,this._y2=b,k};var _=[];_[s]=function(){return this.value},_[r]=function(){return this.value+=this._grow,this.value},_[a]=function(){return this.value*=this._grow,this.value},_[o]=function(){var t=this._b1*this._y1-this._y2;return this.value=this._a2-t,this._y2=this._y1,this._y1=t,this.value},_[u]=function(){var t=this._b1*this._y1-this._y2;return this.value=this._a2+t,this._y2=this._y1,this._y1=t,this.value},_[h]=function(){return this._b1*=this._grow,this.value=this._a2-this._b1,this.value},_[l]=function(){return this._y1+=this._grow,this.value=this._y1*this._y1,this.value},_[c]=function(){return this._y1+=this._grow,this.value=this._y1*this._y1*this._y1,this.value},i.prototype.next=_[s],t.modules.Envelope=e,t.modules.EnvelopeValue=i}(timbre),function(t){"use strict";function e(e){e="number"==typeof e?e:512,e=1<<Math.ceil(Math.log(e)*Math.LOG2E),this.length=e,this.buffer=new t.fn.SignalArray(e),this.real=new t.fn.SignalArray(e),this.imag=new t.fn.SignalArray(e),this._real=new t.fn.SignalArray(e),this._imag=new t.fn.SignalArray(e),this.mag=new t.fn.SignalArray(e>>1),this.minDecibels=-30,this.maxDecibels=-100;var i=n.get(e);this._bitrev=i.bitrev,this._sintable=i.sintable,this._costable=i.costable}var i=e.prototype;i.setWindow=function(e){if("string"==typeof e){var i=/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(e);if(null!==i){var n=i[1].toLowerCase(),r=void 0!==i[2]?+i[2]:.25,a=s[n];if(a){this._window||(this._window=new t.fn.SignalArray(this.length));var o=this._window,u=0,h=this.length;for(r=0>r?0:r>1?1:r;h>u;++u)o[u]=a(u,h,r);this.windowName=e}}}},i.forward=function(t){var e,i,n,s,r,a,o,u,h,l,c,f=this.buffer,p=this.real,d=this.imag,m=this._window,v=this._bitrev,g=this._sintable,b=this._costable,_=f.length;if(m)for(e=0;_>e;++e)f[e]=t[e]*m[e];else f.set(t);for(e=0;_>e;++e)p[e]=f[v[e]],d[e]=0;for(n=1;_>n;n=s)for(r=0,a=_/(s=n+n),i=0;n>i;i++){for(o=b[r],u=g[r],e=i;_>e;e+=s)l=u*d[h=e+n]+o*p[h],c=o*d[h]-u*p[h],p[h]=p[e]-l,p[e]+=l,d[h]=d[e]-c,d[e]+=c;r+=a}var y,w,k=this.mag;for(e=0;_>e;++e)y=p[e],w=d[e],k[e]=Math.sqrt(y*y+w*w);return{real:p,imag:d}},i.inverse=function(t,e){var i,n,s,r,a,o,u,h,l,c,f,p=this.buffer,d=this._real,m=this._imag,v=this._bitrev,g=this._sintable,b=this._costable,_=p.length;for(i=0;_>i;++i)n=v[i],d[i]=+t[n],m[i]=-e[n];for(s=1;_>s;s=r)for(a=0,o=_/(r=s+s),n=0;s>n;n++){for(u=b[a],h=g[a],i=n;_>i;i+=r)c=h*m[l=i+s]+u*d[l],f=u*m[l]-h*d[l],d[l]=d[i]-c,d[i]+=c,m[l]=m[i]-f,m[i]+=f;a+=o}for(i=0;_>i;++i)p[i]=d[i]/_;return p},i.getFrequencyData=function(t){var e,i=this.minDecibels,n=Math.min(this.mag.length,t.length);if(n){var s,r=this.mag,a=0;for(e=0;n>e;++e)s=r[e],t[e]=s?20*Math.log(s)*Math.LOG10E:i,a<t[e]&&(a=t[e])}return t};var n={get:function(e){return n[e]||function(){var i,s,r=function(){var t,i,n,s,r;for(t=new Int16Array(e),r=e>>1,i=n=0;t[i]=n,!(++i>=e);){for(s=r;n>=s;)n-=s,s>>=1;n+=s}return t}(),a=Math.floor(Math.log(e)/Math.LN2),o=new t.fn.SignalArray((1<<a)-1),u=new t.fn.SignalArray((1<<a)-1),h=2*Math.PI;for(i=0,s=o.length;s>i;++i)o[i]=Math.sin(h*(i/e)),u[i]=Math.cos(h*(i/e));return n[e]={bitrev:r,sintable:o,costable:u},n[e]}()}},s=function(){var t=Math.PI,e=2*Math.PI,i=Math.abs,n=Math.pow,s=Math.cos,r=Math.sin,a=function(e){return r(t*e)/(t*e)},o=Math.E;return{rectangular:function(){return 1},hann:function(t,i){return.5*(1-s(e*t/(i-1)))},hamming:function(t,i){return.54-.46*s(e*t/(i-1))},tukery:function(e,i,n){return n*(i-1)/2>e?.5*(1+s(t*(2*e/(n*(i-1))-1))):e>(i-1)*(1-n/2)?.5*(1+s(t*(2*e/(n*(i-1))-2/n+1))):1},cosine:function(e,i){return r(t*e/(i-1))},lanczos:function(t,e){return a(2*t/(e-1)-1)},triangular:function(t,e){return 2/(e+1)*((e+1)/2-i(t-(e-1)/2))},bartlett:function(t,e){return 2/(e-1)*((e-1)/2-i(t-(e-1)/2))},gaussian:function(t,e,i){return n(o,-.5*n((t-(e-1)/2)/(i*(e-1)/2),2))},bartlettHann:function(t,n){return.62-.48*i(t/(n-1)-.5)-.38*s(e*t/(n-1))},blackman:function(i,n,r){var a=r/2;return(1-r)/2-.5*s(e*i/(n-1))+a*s(4*t*i/(n-1))}}}();t.modules.FFT=e}(timbre),function(t){"use strict";function e(t){this.samplerate=t||44100,this.wave=null,this.step=1,this.frequency=0,this.value=0,this.phase=0,this.feedback=!1,this._x=0,this._lastouts=0,this._coeff=i/this.samplerate,this._radtoinc=i/(2*Math.PI)}var i=1024,n=i-1,s=e.prototype;s.setWave=function(e){var n,s,a=this.wave;if(this.wave||(this.wave=new Float32Array(i+1)),"function"==typeof e)for(n=0;i>n;++n)a[n]=e(n/i);else if(t.fn.isSignalArray(e))if(e.length===a.length)a.set(e);else for(s=e.length/i,n=0;i>n;++n)a[n]=e[n*s|0];else"string"==typeof e&&void 0!==(s=r(e))&&this.wave.set(s);this.wave[i]=this.wave[0]},s.clone=function(){var t=new e(this.samplerate);return t.wave=this.wave,t.step=this.step,t.frequency=this.frequency,t.value=this.value,t.phase=this.phase,t.feedback=this.feedback,t},s.reset=function(){this._x=0},s.next=function(){var t=this._x,e=t+this.phase*this._radtoinc|0;return this.value=this.wave[e&n],(t+=this.frequency*this._coeff*this.step)>i&&(t-=i),this._x=t,this.value},s.process=function(t){var e,s,r,a,o,u,h=this.wave,l=this._radtoinc,c=this._x,f=this.frequency*this._coeff,p=this.step;if(this.feedback){var d=this._lastouts;for(l*=this.phase,u=0;p>u;++u)r=(e=c+d*l)-(s=0|e),a=h[s&=n],o=h[s+1],t[u]=d=a+r*(o-a),c+=f;this._lastouts=d}else{var m=this.phase*l;for(u=0;p>u;++u)r=(e=c+m)-(s=0|e),a=h[s&=n],o=h[s+1],t[u]=a+r*(o-a),c+=f}c>i&&(c-=i),this._x=c,this.value=t[t.length-1]},s.processWithFreqArray=function(t,e){var s,r,a,o,u,h,l=this.wave,c=this._radtoinc,f=this._x,p=this._coeff,d=this.step;if(this.feedback){var m=this._lastouts;for(c*=this.phase,h=0;d>h;++h)a=(s=f+m*c)-(r=0|s),o=l[r&=n],u=l[r+1],t[h]=m=o+a*(u-o),f+=e[h]*p;this._lastouts=m}else{var v=this.phase*this._radtoinc;for(h=0;d>h;++h)a=(s=f+v)-(r=0|s),o=l[r&=n],u=l[r+1],t[h]=o+a*(u-o),f+=e[h]*p}f>i&&(f-=i),this._x=f,this.value=t[t.length-1]},s.processWithPhaseArray=function(t,e){var s,r,a,o,u,h,l=this.wave,c=this._radtoinc,f=this._x,p=this.frequency*this._coeff,d=this.step;if(this.feedback){var m=this._lastouts;for(c*=this.phase,h=0;d>h;++h)a=(s=f+m*c)-(r=0|s),o=l[r&=n],u=l[r+1],t[h]=m=o+a*(u-o),f+=p;this._lastouts=m}else for(h=0;d>h;++h)a=(s=f+e[h]*c)-(r=0|s),o=l[r&=n],u=l[r+1],t[h]=o+a*(u-o),f+=p;f>i&&(f-=i),this._x=f,this.value=t[t.length-1]},s.processWithFreqAndPhaseArray=function(t,e,s){var r,a,o,u,h,l,c=this.wave,f=this._radtoinc,p=this._x,d=this._coeff,m=this.step;if(this.feedback){var v=this._lastouts;for(f*=this.phase,l=0;m>l;++l)o=(r=p+v*f)-(a=0|r),u=c[a&=n],h=c[a+1],t[l]=v=u+o*(h-u),p+=e[l]*d;this._lastouts=v}else for(l=0;m>l;++l)o=(r=p+s[l]*i)-(a=0|r),u=c[a&=n],h=c[a+1],t[l]=u+o*(h-u),p+=e[l]*d;p>i&&(p-=i),this._x=p,this.value=t[t.length-1]};var r=function(t){var e,i=a[t];if(void 0!==i)return"function"==typeof i&&(i=i()),i;if(null!==(e=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(t))&&void 0!==(i=function(t,e,i,n){var s,r,o,u,h,l=a[e];if(void 0!==l){switch("function"==typeof l&&(l=l()),i){case"@1":for(r=512;1024>r;++r)l[r]=0;break;case"@2":for(r=512;1024>r;++r)l[r]=Math.abs(l[r]);break;case"@3":for(r=256;512>r;++r)l[r]=0;for(r=512;768>r;++r)l[r]=Math.abs(l[r]);for(r=768;1024>r;++r)l[r]=0;break;case"@4":for(s=new Float32Array(1024),r=0;512>r;++r)s[r]=l[r<<1];l=s;break;case"@5":for(s=new Float32Array(1024),r=0;512>r;++r)s[r]=Math.abs(l[r<<1]);l=s}if(void 0!==n&&50!==n){for(n=0>(n*=.01)?0:n>1?1:n,s=new Float32Array(1024),o=1024*n|0,r=0;o>r;++r)s[r]=l[r/o*512|0];for(h=1024-o,u=0;1024>r;++r,++u)s[r]=l[u/h*512+512|0];l=s}if("+"===t)for(r=0;1024>r;++r)l[r]=.5*l[r]+.5;else if("-"===t)for(r=0;1024>r;++r)l[r]*=-1;return l}}(e[1],e[2],e[3],e[4])))return a[t]=i,i;return null!==(e=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(t))?function(t){var e=new Float32Array(1024),i=t.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(i))for(var n=0,s=0;i>n;++n){var r=parseInt(t.substr(2*n,2),16);r=128&r?(r-256)/128:r/127;for(var a=0,o=1024/i;o>a;++a)e[s++]=r}return e}(e[1]):null!==(e=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(t))?function(t){var e=new Float32Array(1024);if(8===t.length){var i,n,s=parseInt(t,16),r=new Float32Array(8);for(r[0]=1,i=0;7>i;++i)r[i+1]=.0625*(15&s),s>>=4;for(i=0;8>i;++i){var a=0,o=(i+1)/1024;for(n=0;1024>n;++n)e[n]+=Math.sin(2*Math.PI*a)*r[i],a+=o}var u,h=0;for(i=0;1024>i;++i)h<(u=Math.abs(e[i]))&&(h=u);if(h>0)for(i=0;1024>i;++i)e[i]/=h}return e}(e[1]):void 0};e.getWavetable=r;e.setWavetable=function(e,i){var n,s,r=new Float32Array(1024);if("function"==typeof i)for(s=0;1024>s;++s)r[s]=i(s/1024);else if(t.fn.isSignalArray(i))if(i.length===r.length)r.set(i);else for(n=i.length/1024,s=0;1024>s;++s)r[s]=i[s*n|0];a[e]=r};var a={sin:function(){for(var t=new Float32Array(1024),e=0;1024>e;++e)t[e]=Math.sin(2*Math.PI*(e/1024));return t},cos:function(){for(var t=new Float32Array(1024),e=0;1024>e;++e)t[e]=Math.cos(2*Math.PI*(e/1024));return t},pulse:function(){for(var t=new Float32Array(1024),e=0;1024>e;++e)t[e]=512>e?1:-1;return t},tri:function(){for(var t,e=new Float32Array(1024),i=0;1024>i;++i)t=i/1024-.25,e[i]=1-4*Math.abs(Math.round(t)-t);return e},saw:function(){for(var t,e=new Float32Array(1024),i=0;1024>i;++i)t=i/1024,e[i]=2*(t-Math.round(t));return e},fami:function(){for(var t=[0,.125,.25,.375,.5,.625,.75,.875,.875,.75,.625,.5,.375,.25,.125,0,-.125,-.25,-.375,-.5,-.625,-.75,-.875,-1,-1,-.875,-.75,-.625,-.5,-.375,-.25,-.125],e=new Float32Array(1024),i=0;1024>i;++i)e[i]=t[i/1024*t.length|0];return e},konami:function(){for(var t=[-.625,-.875,-.125,.75,.5,.125,.5,.75,.25,-.125,.5,.875,.625,0,.25,.375,-.125,-.75,0,.625,.125,-.5,-.375,-.125,-.75,-1,-.625,0,-.375,-.875,-.625,-.25],e=new Float32Array(1024),i=0;1024>i;++i)e[i]=t[i/1024*t.length|0];return e}};t.modules.Oscillator=e}(timbre),function(t){"use strict";function e(e,a){this.samplerate=e;var o,u,h=e/44100;for(u=2*s.length,this.comb=new Array(u),this.combout=new Array(u),o=0;u>o;++o)this.comb[o]=new i(s[o%s.length]*h),this.combout[o]=new t.fn.SignalArray(a);for(u=2*r.length,this.allpass=new Array(u),o=0;u>o;++o)this.allpass[o]=new n(r[o%r.length]*h);this.outputs=[new t.fn.SignalArray(a),new t.fn.SignalArray(a)],this.damp=0,this.wet=.33,this.setRoomSize(.5),this.setDamp(.5)}function i(e){this.buffer=new t.fn.SignalArray(0|e),this.buffersize=this.buffer.length,this.bufidx=0,this.feedback=0,this.filterstore=0,this.damp=0}function n(e){this.buffer=new t.fn.SignalArray(0|e),this.buffersize=this.buffer.length,this.bufidx=0}var s=[1116,1188,1277,1356,1422,1491,1557,1617],r=[225,556,441,341],a=e.prototype;a.setRoomSize=function(t){var e=this.comb,i=.28*t+.7;this.roomsize=t,e[0].feedback=e[1].feedback=e[2].feedback=e[3].feedback=e[4].feedback=e[5].feedback=e[6].feedback=e[7].feedback=e[8].feedback=e[9].feedback=e[10].feedback=e[11].feedback=e[12].feedback=e[13].feedback=e[14].feedback=e[15].feedback=i},a.setDamp=function(t){var e=this.comb,i=.4*t;this.damp=t,e[0].damp=e[1].damp=e[2].damp=e[3].damp=e[4].damp=e[5].damp=e[6].damp=e[7].damp=e[8].damp=e[9].damp=e[10].damp=e[11].damp=e[12].damp=e[13].damp=e[14].damp=e[15].damp=i},a.process=function(t,e){var i,n=this.comb,s=this.combout,r=this.allpass,a=this.outputs[0],o=this.outputs[1],u=this.wet,h=1-u,l=t.length;for(n[0].process(t,s[0]),n[1].process(t,s[1]),n[2].process(t,s[2]),n[3].process(t,s[3]),n[4].process(t,s[4]),n[5].process(t,s[5]),n[6].process(t,s[6]),n[7].process(t,s[7]),n[8].process(e,s[8]),n[9].process(e,s[9]),n[10].process(e,s[10]),n[11].process(e,s[11]),n[12].process(e,s[12]),n[13].process(e,s[13]),n[14].process(e,s[14]),n[15].process(e,s[15]),i=0;l>i;++i)a[i]=s[0][i]+s[1][i]+s[2][i]+s[3][i]+s[4][i]+s[5][i]+s[6][i]+s[7][i],o[i]=s[8][i]+s[9][i]+s[10][i]+s[11][i]+s[12][i]+s[13][i]+s[14][i]+s[15][i];for(r[0].process(a,a),r[1].process(a,a),r[2].process(a,a),r[3].process(a,a),r[4].process(o,o),r[5].process(o,o),r[6].process(o,o),r[7].process(o,o),i=0;l>i;++i)t[i]=a[i]*u+t[i]*h,e[i]=o[i]*u+e[i]*h},i.prototype.process=function(t,e){var i,n,s,r=this.buffer,a=this.buffersize,o=this.bufidx,u=this.filterstore,h=this.feedback,l=this.damp,c=1-l,f=t.length;for(s=0;f>s;++s)i=.015*t[s],u=(n=r[o])*c+u*l,r[o]=i+u*h,++o>=a&&(o=0),e[s]=n;this.bufidx=o,this.filterstore=u},n.prototype.process=function(t,e){var i,n,s,r,a=this.buffer,o=this.buffersize,u=this.bufidx,h=t.length;for(r=0;h>r;++r)n=-(i=t[r])+(s=a[u]),a[u]=i+.5*s,++u>=o&&(u=0),e[r]=n;this.bufidx=u},t.modules.Reverb=e}(timbre),function(t){"use strict";function e(t){return new i(t)}function i(t){if(this.fragments=[],t){var e=t.samplerate||44100,i=t.buffer[0].length/e;this.fragments.push(new n(t,0,i))}}function n(t,e,i,n,s,r,o){t||(t=a),this.buffer=t.buffer[0],this.samplerate=t.samplerate||44100,this.start=e,this._duration=i,this.reverse=n||!1,this.pitch=s||100,this.stretch=r||!1,this.pan=o||50}function s(t,e){this.tape=t,this.fragments=t.fragments,this.samplerate=e||44100,this.isEnded=!1,this.buffer=null,this.bufferIndex=0,this.bufferIndexIncr=0,this.bufferBeginIndex=0,this.bufferEndIndex=0,this.fragment=null,this.fragmentIndex=0,this.panL=.5,this.panR=.5}var r=new Float32Array(60),a={buffer:r,samplerate:1};e.silence=function(t){return new e(a).slice(0,1).fill(t)},e.join=function(t){for(var e=new i,n=0;n<t.length;n++)t[n]instanceof i&&e.add_fragments(t[n].fragments);return e},e.Tape=i,i.prototype.add_fragment=function(t){return this.fragments.push(t),this},i.prototype.add_fragments=function(t){for(var e=0;e<t.length;e++)this.fragments.push(t[e]);return this},i.prototype.duration=function(){for(var t=0,e=0;e<this.fragments.length;e++)t+=this.fragments[e].duration();return t},i.prototype.slice=function(t,e){var n=this.duration();t+e>n&&(e=n-t);for(var s=new i,r=t,a=e,o=0;o<this.fragments.length;o++){var u=this.fragments[o].create(r,a),h=u[0];if(r=u[1],a=u[2],h&&s.add_fragment(h),0===a)break}return s},i.prototype.cut=i.prototype.slice,i.prototype.concat=function(t){var e=new i;return e.add_fragments(this.fragments),e.add_fragments(t.fragments),e},i.prototype.loop=function(t){var e,n=[];for(e=0;e<this.fragments.length;e++)n.push(this.fragments[e].clone());var s=new i;for(e=0;t>e;e++)s.add_fragments(n);return s},i.prototype.times=i.prototype.loop,i.prototype.split=function(t){for(var e=this.duration()/t,i=[],n=0;t>n;n++)i.push(this.slice(n*e,e));return i},i.prototype.fill=function(t){var e=this.duration();if(0===e)throw"EmptyFragment";var i=t/e|0,n=t%e;return this.loop(i).plus(this.slice(0,n))},i.prototype.replace=function(t,n,s){var r=new i,a=t+n,o=(r=r.plus(this.slice(0,t))).duration();t>o&&(r=r.plus(e.silence(t-o))),r=r.plus(s);var u=this.duration();return u>a&&(r=r.plus(this.slice(a,u-a))),r},i.prototype.reverse=function(){for(var t=new i,e=this.fragments.length;e--;){var n=this.fragments[e].clone();n.reverse=!n.isReversed(),t.add_fragment(n)}return t},i.prototype.pitch=function(t,e){var n=new i;e=e||!1;for(var s=0;s<this.fragments.length;s++){var r=this.fragments[s].clone();r.pitch*=.01*t,r.stretch=e,n.add_fragment(r)}return n},i.prototype.stretch=function(t){var e=1/(.01*t)*100;return this.pitch(e,!0)},i.prototype.pan=function(t){var e=new i;t>100?t=100:0>t&&(t=0);for(var n=0;n<this.fragments.length;n++){var s=this.fragments[n].clone();s.pan=t,e.add_fragment(s)}return e},i.prototype.silence=function(){return e.silence(this.duration())},i.prototype.join=function(t){for(var e=new i,n=0;n<t.length;n++)t[n]instanceof i&&e.add_fragments(t[n].fragments);return e},i.prototype.getBuffer=function(){var t=44100;this.fragments.length>0&&(t=this.fragments[0].samplerate);var e=new s(this,t),i=this.duration()*t|0;return{samplerate:t,buffer:e.fetch(i)}},n.prototype.duration=function(){return this._duration*(100/this.pitch)},n.prototype.original_duration=function(){return this._duration},n.prototype.isReversed=function(){return this.reverse},n.prototype.isStretched=function(){return this.stretched},n.prototype.create=function(t,e){var i,n=this.duration();if(t>=n)return[null,t-n,e];t+e>=n?e-=i=n-t:(i=e,e=0);var s=this.clone();return s.start=this.start+t*this.pitch*.01,s._duration=i*this.pitch*.01,s.reverse=!1,[s,0,e]},n.prototype.clone=function(){var t=new n;return t.buffer=this.buffer,t.samplerate=this.samplerate,t.start=this.start,t._duration=this._duration,t.reverse=this.reverse,t.pitch=this.pitch,t.stretch=this.stretch,t.pan=this.pan,t},e.Fragment=n,e.TapeStream=s,s.prototype.reset=function(){return this.isEnded=!1,this.buffer=null,this.bufferIndex=0,this.bufferIndexIncr=0,this.bufferBeginIndex=0,this.bufferEndIndex=0,this.fragment=null,this.fragmentIndex=0,this.panL=.5,this.panR=.5,this.isLooped=!1,this},s.prototype.fetch=function(e){var i=new t.fn.SignalArray(e),n=new t.fn.SignalArray(e),s=this.fragments;if(0===s.length)return[i,n];for(var a,o=100*this.samplerate,u=this.buffer,h=this.bufferIndex,l=this.bufferIndexIncr,c=this.bufferBeginIndex,f=this.bufferEndIndex,p=this.fragment,d=this.fragmentIndex,m=this.panL,v=this.panR,g=0;e>g;g++){for(;!u||c>h||h>=f;)if(!p||d<s.length)u=(p=s[d++]).buffer,l=p.samplerate/o*p.pitch,f=(c=p.start*p.samplerate)+p.original_duration()*p.samplerate,m=1-(a=.01*p.pan),v=a,p.reverse?h=f+(l*=-1):h=c;else{if(!this.isLooped){this.isEnded=!0,u=r,l=0,h=0;break}u=null,h=0,l=0,c=0,f=0,p=null,d=0}i[g]=u[0|h]*m,n[g]=u[0|h]*v,h+=l}return this.buffer=u,this.bufferIndex=h,this.bufferIndexIncr=l,this.bufferBeginIndex=c,this.bufferEndIndex=f,this.fragment=p,this.fragmentIndex=d,this.panL=m,this.panR=v,[i,n]},t.modules.Scissor=e}(timbre),function(t){"use strict";function e(e){this.samplerate=e;var i=Math.ceil(Math.log(1.5*e)*Math.LOG2E);this.buffersize=1<<i,this.buffermask=this.buffersize-1,this.writeBufferL=new t.fn.SignalArray(this.buffersize),this.writeBufferR=new t.fn.SignalArray(this.buffersize),this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR,this.delaytime=null,this.feedback=null,this.cross=null,this.mix=null,this.prevL=0,this.prevR=0,this.readIndex=0,this.writeIndex=0,this.setParams(125,.25,!1,.45)}var i=e.prototype;i.setParams=function(t,e,i,n){if(this.delaytime!==t){this.delaytime=t;var s=.001*t*this.samplerate|0;s>this.buffermask&&(s=this.buffermask),this.writeIndex=this.readIndex+s&this.buffermask}this.feedback!==e&&(this.feedback=e),this.cross!==i&&(this.cross=i,i?(this.readBufferL=this.writeBufferR,this.readBufferR=this.writeBufferL):(this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR)),this.mix!==n&&(this.mix=n)},i.process=function(t,e){var i,n,s=this.readBufferL,r=this.readBufferR,a=this.writeBufferL,o=this.writeBufferR,u=this.readIndex,h=this.writeIndex,l=this.buffermask,c=this.feedback,f=this.mix,p=1-f,d=this.prevL,m=this.prevR,v=t.length;for(n=0;v>n;++n)i=s[u],a[h]=t[n]-i*c,t[n]=d=.5*(t[n]*p+i*f+d),i=r[u],o[h]=e[n]-i*c,e[n]=m=.5*(e[n]*p+i*f+m),u+=1,h=h+1&l;this.readIndex=u&this.buffermask,this.writeIndex=h,this.prevL=d,this.prevR=m},t.modules.StereoDelay=e}(timbre),function(t){"use strict";var e=t.fn,i=t.modules;e.register("audio",(function(t){var i=new(e.getClass("buffer"))(t);return i.playbackState=e.FINISHED_STATE,i._.isLoaded=!1,Object.defineProperties(i,{isLoaded:{get:function(){return this._.isLoaded}}}),i.load=n,i.loadthis=s,i}));var n=function(n){var s=this,r=this._,a=new i.Deferred(this),o=arguments,u=1;a.done((function(){s._.emit("done")})),"function"==typeof o[u]&&(a.done(o[u++]),"function"==typeof o[u]&&a.fail(o[u++])),r.loadedTime=0;var h=function(i,n){var r=s._;i?(s.playbackState=e.PLAYING_STATE,r.samplerate=i.samplerate,r.channels=i.channels,r.bufferMix=null,r.buffer=i.buffer,r.phase=0,r.phaseIncr=i.samplerate/t.samplerate,r.duration=1e3*i.duration,r.currentTime=0,r.isReversed&&(r.phaseIncr*=-1,r.phase=i.buffer[0].length+r.phaseIncr),s._.emit("loadedmetadata")):a.reject(n)},l=function(){s._.isLoaded=!0,s._.plotFlush=!0,s._.emit("loadeddata"),a.resolveWith(s)};return(new i.Decoder).decode(n,h,l),a.promise()},s=function(){return n.apply(this,arguments),this}}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var n=this._;n.biquad=new s(n.samplerate),n.freq=t(340),n.band=t(1),n.gain=t(0),n.plotBefore=r,n.plotRange=[-18,18],n.plotFlush=!0}var i=t.fn,n=t.modules.FFT,s=t.modules.Biquad;i.extend(e);var r=function(t,e,i,n,s){t.lineWidth=1,t.strokeStyle="rgb(192, 192, 192)";for(var r=.5*this._.samplerate,a=1;10>=a;++a)for(var o=1;4>=o;o++){var u=a*Math.pow(10,o);if(!(20>=u||u>=r)){t.beginPath();var h=Math.log(u/20)/Math.log(r/20);h=.5+(h*n+e|0),t.moveTo(h,i),t.lineTo(h,i+s),t.stroke()}}var l=s/6;for(a=1;6>a;a++){t.beginPath();var c=.5+(i+a*l|0);t.moveTo(e,c),t.lineTo(e+n,c),t.stroke()}},a=e.prototype;Object.defineProperties(a,{type:{set:function(t){var e=this._;t!==e.biquad.type&&(e.biquad.setType(t),e.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(e){this._.freq=t(e)},get:function(){return this._.freq}},cutoff:{set:function(e){this._.freq=t(e)},get:function(){return this._.freq}},res:{set:function(e){this._.band=t(e)},get:function(){return this._.band}},Q:{set:function(e){this._.band=t(e)},get:function(){return this._.band}},band:{set:function(e){this._.band=t(e)},get:function(){return this._.band}},gain:{set:function(e){this._.gain=t(e)},get:function(){return this._.gain}}}),a.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,i.inputSignalAR(this);var n=e.freq.process(t).cells[0][0],s=e.band.process(t).cells[0][0],r=e.gain.process(t).cells[0][0];(e.prevFreq!==n||e.prevband!==s||e.prevGain!==r)&&(e.prevFreq=n,e.prevband=s,e.prevGain=r,e.biquad.setParams(n,s,r),e.plotFlush=!0),e.bypassed||e.biquad.process(this.cells[1],this.cells[2]),i.outputSignalAR(this)}return this};var o=new n(2048),u=t.Object.prototype.plot;a.plot=function(t){if(this._.plotFlush){var e=new s(this._.samplerate);e.setType(this.type),e.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf());var i=new Float32Array(o.length);i[0]=1,e.process(i,i),o.forward(i);var n,r,a,h,l,c=512,f=new Float32Array(c),p=.5*this._.samplerate,d=new Float32Array(c);for(o.getFrequencyData(d),n=0;c>n;++n)h=(r=20*Math.pow(p/20,n/c)/(p/d.length))-(a=0|r),0===a?l=d[a]:l=(1-h)*d[a-1]+h*d[a],f[n]=l;this._.plotData=f,this._.plotFlush=null}return u.call(this,t)},i.register("biquad",e),i.register("lowpass",(function(t){return new e(t).set("type","lowpass")})),i.register("highpass",(function(t){return new e(t).set("type","highpass")})),i.register("bandpass",(function(t){return new e(t).set("type","bandpass")})),i.register("lowshelf",(function(t){return new e(t).set("type","lowshelf")})),i.register("highshelf",(function(t){return new e(t).set("type","highshelf")})),i.register("peaking",(function(t){return new e(t).set("type","peaking")})),i.register("notch",(function(t){return new e(t).set("type","notch")})),i.register("allpass",(function(t){return new e(t).set("type","allpass")})),i.alias("lpf","lowpass"),i.alias("hpf","highpass"),i.alias("bpf","bandpass"),i.alias("bef","notch"),i.alias("brf","notch"),i.alias("apf","allpass")}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.fixAR(this);var n=this._;n.pitch=t(1),n.samplerate=44100,n.channels=0,n.bufferMix=null,n.buffer=[],n.isLooped=!1,n.isReversed=!1,n.duration=0,n.currentTime=0,n.currentTimeObj=null,n.phase=0,n.phaseIncr=0,n.onended=i.make_onended(this,0),n.onlooped=r(this)}var i=t.fn,n=t.modules.Scissor.Tape,s=function(t){return i.isSignalArray(t)||t instanceof Float32Array};i.extend(e);var r=function(t){return function(){var e=t._;e.phase>=e.buffer[0].length?e.phase=0:e.phase<0&&(e.phase=e.buffer[0].length+e.phaseIncr),t._.emit("looped")}},a=e.prototype,o=function(e){var i=this._;if("object"==typeof e){var r,a=[];s(e)?(a[0]=e,1):"object"==typeof e&&(e instanceof t.Object?e=e.buffer:e instanceof n&&(e=e.getBuffer()),Array.isArray(e.buffer)?s(e.buffer[0])&&(s(e.buffer[1])&&s(e.buffer[2])?(2,a=e.buffer):(1,a=[e.buffer[0]])):s(e.buffer)&&(1,a=[e.buffer]),"number"==typeof e.samplerate&&(r=e.samplerate)),a.length&&(r>0&&(i.samplerate=e.samplerate),i.bufferMix=null,i.buffer=a,i.phase=0,i.phaseIncr=i.samplerate/t.samplerate,i.duration=1e3*i.buffer[0].length/i.samplerate,i.currentTime=0,i.plotFlush=!0,this.reverse(i.isReversed))}};Object.defineProperties(a,{buffer:{set:o,get:function(){var t=this._;return{samplerate:t.samplerate,channels:t.channels,buffer:t.buffer}}},pitch:{set:function(e){this._.pitch=t(e)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},samplerate:{get:function(){return this._.samplerate}},duration:{get:function(){return this._.duration}},currentTime:{set:function(e){if("number"==typeof e){var i=this._;e>=0&&e<=i.duration&&(i.phase=e/1e3*i.samplerate,i.currentTime=e)}else e instanceof t.Object?this._.currentTimeObj=e:null===e&&(this._.currentTimeObj=null)},get:function(){return this._.currentTimeObj?this._.currentTimeObj:this._.currentTime}}}),a.clone=function(){var t=this._,e=i.clone(this);return t.buffer.length&&o.call(e,{buffer:t.buffer,samplerate:t.samplerate,channels:t.channels}),e.loop(t.isLooped),e.reverse(t.isReversed),e},a.slice=function(e,n){var s=this._,r=t(s.originkey),a=s.isReversed;if(s.buffer.length){if((e="number"==typeof e?.001*e*s.samplerate|0:0)>(n="number"==typeof n?.001*n*s.samplerate|0:s.buffer[0].length)){var u=e;e=n,n=u,a=!a}2===s.channels?o.call(r,{buffer:[i.pointer(s.buffer[0],e,n-e),i.pointer(s.buffer[1],e,n-e),i.pointer(s.buffer[2],e,n-e)],samplerate:s.samplerate}):o.call(r,{buffer:i.pointer(s.buffer[0],e,n-e),samplerate:s.samplerate}),r.playbackState=i.PLAYING_STATE}return r.loop(s.isLooped),r.reverse(s.isReversed),r},a.reverse=function(t){var e=this._;return e.isReversed=!!t,e.isReversed?(e.phaseIncr>0&&(e.phaseIncr*=-1),0===e.phase&&e.buffer.length&&(e.phase=e.buffer[0].length+e.phaseIncr)):e.phaseIncr<0&&(e.phaseIncr*=-1),this},a.loop=function(t){return this._.isLooped=!!t,this},a.bang=function(t){return this.playbackState=!1===t?i.FINISHED_STATE:i.PLAYING_STATE,this._.phase=0,this._.emit("bang"),this},a.process=function(t){var e=this._;if(!e.buffer.length)return this;if(this.tickID!==t){this.tickID=t;var n,s,r,a=this.cells[1],o=this.cells[2],u=e.phase,h=e.cellsize;if(2===e.channels?(s=e.buffer[1],r=e.buffer[2]):s=r=e.buffer[0],e.currentTimeObj){var l,c=e.currentTimeObj.process(t).cells[0],f=.001*e.samplerate;for(n=0;h>n;++n)u=(l=c[n])*f,a[n]=s[0|u]||0,o[n]=r[0|u]||0;e.phase=u,e.currentTime=l}else{var p=e.pitch.process(t).cells[0][0],d=e.phaseIncr*p;for(n=0;h>n;++n)a[n]=s[0|u]||0,o[n]=r[0|u]||0,u+=d;(u>=s.length||0>u)&&i.nextTick(e.isLooped?e.onlooped:e.onended),e.phase=u,e.currentTime+=i.currentTimeIncr}i.outputSignalAR(this)}return this};var u=t.Object.prototype.plot;a.plot=function(t){var e,i,n=this._;if(n.plotFlush){2===n.channels?(e=n.buffer[1],i=n.buffer[2]):e=i=n.buffer[0];for(var s=new Float32Array(2048),r=0,a=e.length/2048,o=0;2048>o;o++)s[o]=.5*(e[0|r]+i[0|r]),r+=a;n.plotData=s,n.plotFlush=null}return u.call(this,t)},i.register("buffer",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var s=new n(this._.samplerate);s.setDelayTime(20),s.setRate(4),s.depth=20,s.feedback=.2,s.mix=.33,this._.chorus=s}var i=t.fn,n=t.modules.Chorus;i.extend(e);var s=e.prototype;Object.defineProperties(s,{type:{set:function(t){this._.chorus.setDelayTime(t)},get:function(){return this._.chorus.wave}},delay:{set:function(t){t>=.5&&80>=t&&this._.chorus.setDelayTime(t)},get:function(){return this._.chorus.delayTime}},rate:{set:function(t){"number"==typeof t&&t>0&&this._.chorus.setRate(t)},get:function(){return this._.chorus.rate}},depth:{set:function(t){"number"==typeof t&&t>=0&&100>=t&&(t*=this._.samplerate/44100,this._.chorus.depth=t)},get:function(){return this._.chorus.depth}},fb:{set:function(t){"number"==typeof t&&t>=-1&&1>=t&&(this._.chorus.feedback=.99996*t)},get:function(){return this._.chorus.feedback}},mix:{set:function(e){this._.mix=t(e)},get:function(){return this._.mix}}}),s.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,i.inputSignalAR(this),e.bypassed||e.chorus.process(this.cells[1],this.cells[2]),i.outputSignalAR(this)),this},i.register("chorus",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e);var i=this._;i.min=-.8,i.max=.8}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{minmax:{set:function(t){var e=this._;"number"==typeof t&&(e.min=-Math.abs(t),e.max=-e.min)},get:function(){return this._.max}},min:{set:function(t){var e=this._;"number"==typeof t&&(e.max<t?e.max=t:e.min=t)},get:function(){return this._.min}},max:{set:function(t){var e=this._;"number"==typeof t&&(t<e.min?e.min=t:e.max=t)},get:function(){return this._.max}}}),n.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,s,r=this.cells[1],a=this.cells[2],o=r.length,u=e.min,h=e.max;if(e.ar){for(i.inputSignalAR(this),n=0;o>n;++n)u>(s=r[n])?s=u:s>h&&(s=h),r[n]=s,u>(s=a[n])?s=u:s>h&&(s=h),a[n]=s;i.outputSignalAR(this)}else u>(s=i.inputSignalKR(this))?s=u:s>h&&(s=h),this.cells[0][0]=s,i.outputSignalKR(this)}return this},i.register("clip",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var n=this._;n.prevThresh=-24,n.prevKnee=30,n.prevRatio=12,n.thresh=t(n.prevThresh),n.knee=t(n.prevKnee),n.ratio=t(n.prevRatio),n.postGain=6,n.reduction=0,n.attack=3,n.release=25,n.comp=new s(n.samplerate),n.comp.dbPostGain=n.postGain,n.comp.setAttackTime(.001*n.attack),n.comp.setReleaseTime(.001*n.release),n.comp.setPreDelayTime(6),n.comp.setParams(n.prevThresh,n.prevKnee,n.prevRatio)}var i=t.fn,n=t.timevalue,s=t.modules.Compressor;i.extend(e);var r=e.prototype;Object.defineProperties(r,{thresh:{set:function(e){this._.thresh=t(e)},get:function(){return this._.thresh}},thre:{set:function(e){this._.thresh=t(e)},get:function(){return this._.thre}},knee:{set:function(e){this._.kne=t(e)},get:function(){return this._.knee}},ratio:{set:function(e){this._.ratio=t(e)},get:function(){return this._.ratio}},gain:{set:function(t){"number"==typeof t&&(this._.comp.dbPostGain=t)},get:function(){return this._.comp.dbPostGain}},attack:{set:function(t){"string"==typeof t&&(t=n(t)),"number"==typeof t&&(t=0>t?0:t>1e3?1e3:t,this._.attack=t,this._.comp.setAttackTime(.001*t))},get:function(){return this._.attack}},release:{set:function(t){"string"==typeof t&&(t=n(t)),"number"==typeof t&&(t=0>t?0:t>1e3?1e3:t,this._.release=t,this._.comp.setReleaseTime(.001*t))},get:function(){return this._.release}},reduction:{get:function(){return this._.reduction}}}),r.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,i.inputSignalAR(this);var n=e.thresh.process(t).cells[0][0],s=e.knee.process(t).cells[0][0],r=e.ratio.process(t).cells[0][0];(e.prevThresh!==n||e.prevKnee!==s||e.prevRatio!==r)&&(e.prevThresh=n,e.prevKnee=s,e.prevRatio=r,e.comp.setParams(n,s,r)),e.bypassed||(e.comp.process(this.cells[1],this.cells[2]),e.reduction=e.comp.meteringGain),i.outputSignalAR(this)}return this},i.register("comp",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var n=this._;n.time=t(100),n.fb=t(.2),n.cross=t(!1),n.mix=.33,n.delay=new s(n.samplerate)}var i=t.fn,n=t.timevalue,s=t.modules.StereoDelay;i.extend(e);var r=e.prototype;Object.defineProperties(r,{time:{set:function(e){"string"==typeof e&&(e=n(e)),this._.time=t(e)},get:function(){return this._.time}},fb:{set:function(e){this._.fb=t(e)},get:function(){return this._.fb}},cross:{set:function(e){this._.cross=t(e)},get:function(){return this._.cross}},mix:{set:function(t){"number"==typeof t&&(t=t>1?1:0>t?0:t,this._.mix=t)},get:function(){return this._.mix}}}),r.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n=e.time.process(t).cells[0][0],s=e.fb.process(t).cells[0][0],r=0!==e.cross.process(t).cells[0][0],a=e.mix;(e.prevTime!==n||e.prevFb!==s||e.prevCross!==r||e.prevMix!==a)&&(e.prevTime=n,e.prevFb=s,e.prevCross=r,e.prevMix=a,e.delay.setParams(n,s,r,a)),i.inputSignalAR(this),e.bypassed||e.delay.process(this.cells[1],this.cells[2]),i.outputSignalAR(this)}return this},i.register("delay",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var n=this._;n.pre=t(60),n.post=t(-18),n.x1L=n.x2L=n.y1L=n.y2L=0,n.x1R=n.x2R=n.y1R=n.y2R=0,n.b0=n.b1=n.b2=n.a1=n.a2=0,n.cutoff=0,n.Q=1,n.preScale=0,n.postScale=0}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{cutoff:{set:function(t){"number"==typeof t&&t>0&&(this._.cutoff=t)},get:function(){return this._.cutoff}},pre:{set:function(e){this._.pre=t(e)},get:function(){return this._.pre}},post:{set:function(e){this._.post=t(e)},get:function(){return this._.post}}}),n.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,i.inputSignalAR(this);var n=-e.pre.process(t).cells[0][0],r=-e.post.process(t).cells[0][0];if((e.prevPreGain!==n||e.prevPostGain!==r)&&(e.prevPreGain=n,e.prevPostGain=r,e.preScale=Math.pow(10,.05*-n),e.postScale=Math.pow(10,.05*-r)),!e.bypassed){var a,o,u,h,l,c=this.cells[1],f=this.cells[2],p=e.preScale,d=e.postScale;if(e.cutoff){e.prevCutoff!==e.cutoff&&(e.prevCutoff=e.cutoff,s(e));var m=e.x1L,v=e.x2L,g=e.y1L,b=e.y2L,_=e.x1R,y=e.x2R,w=e.y1R,k=e.y2R,x=e.b0,S=e.b1,A=e.b2,I=e.a1,T=e.a2;for(a=0,o=c.length;o>a;++a)-1>(u=(l=x*(h=c[a]*p)+S*m+A*v-I*g-T*b)*d)?u=-1:u>1&&(u=1),c[a]=u,v=m,m=h,b=g,g=l,-1>(u=(l=x*(h=f[a]*p)+S*_+A*y-I*w-T*k)*d)?u=-1:u>1&&(u=1),f[a]=u,y=_,_=h,k=w,w=l;e.x1L=m,e.x2L=v,e.y1L=g,e.y2L=b,e.x1R=_,e.x2R=y,e.y1R=w,e.y2R=k}else for(a=0,o=c.length;o>a;++a)-1>(u=c[a]*p*d)?u=-1:u>1&&(u=1),c[a]=u,-1>(u=f[a]*p*d)?u=-1:u>1&&(u=1),f[a]=u}i.outputSignalAR(this)}return this};var s=function(t){var e=2*Math.PI*t.cutoff/t.samplerate,i=Math.cos(e),n=Math.sin(e)/(2*t.Q),s=1/(1+n);t.b0=.5*(1-i)*s,t.b1=1-i*s,t.b2=.5*(1-i)*s,t.a1=-2*i*s,t.a2=1-n*s};i.register("dist",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),this._.ar=!1}var i=t.fn;i.extend(e),e.prototype.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,s,r,a,o,u,h=this.nodes,l=this.cells[0],c=this.cells[1],f=this.cells[2],p=h.length,d=l.length;if(e.ar){if(h.length>0)for(h[0].process(t),a=h[0].cells[1],o=h[0].cells[2],c.set(a),f.set(o),n=1;p>n;++n)for(h[n].process(t),a=h[n].cells[1],o=h[n].cells[2],s=0;d>s;++s)u=a[s],c[s]=0===u?0:c[s]/u,u=o[s],f[s]=0===u?0:f[s]/u;else for(s=0;d>s;++s)c[s]=f[n]=0;i.outputSignalAR(this)}else{if(h.length>0)for(r=h[0].process(t).cells[0][0],n=1;p>n;++n)r=0===(u=h[n].process(t).cells[0][0])?0:r/u;else r=0;l[0]=r,i.outputSignalKR(this)}}return this},i.register("/",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e);var i=this._;i.env=new r(i.samplerate),i.env.setStep(i.cellsize),i.tmp=new n.SignalArray(i.cellsize),i.ar=!1,i.plotFlush=!0,i.onended=u(this),this.on("ar",o)}function i(t,e,i,n,s,r){var a=i;return"number"==typeof t[n]?a=t[n]:"number"==typeof t[s]?a=t[s]:r&&("string"==typeof t[n]?a=r(t[n]):"string"==typeof t[s]&&(a=r(t[s]))),e>a&&(a=e),a}var n=t.fn,s=t.timevalue,r=t.modules.Envelope,a=n.isDictionary;n.extend(e);var o=function(t){this._.env.setStep(t?1:this._.cellsize)},u=function(t){return function(){t._.emit("ended")}},h=e.prototype;Object.defineProperties(h,{table:{set:function(t){Array.isArray(t)&&(l.call(this,t),this._.plotFlush=!0)},get:function(){return this._.env.table}},curve:{set:function(t){this._.env.setCurve(t)},get:function(){return this._.env.curve}},releaseNode:{set:function(t){this._.env.setReleaseNode(t),this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(t){this._.env.setLoopNode(t),this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}}),h.clone=function(){var t=n.clone(this);return t._.env=this._.env.clone(),t},h.reset=function(){return this._.env.reset(),this},h.release=function(){var t=this._;return t.env.release(),t.emit("released"),this},h.bang=function(){var t=this._;return t.env.reset(),t.env.status=r.StatusGate,t.emit("bang"),this},h.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s=this.cells[1],r=this.cells[2],a=e.cellsize;if(this.nodes.length)n.inputSignalAR(this);else for(i=0;a>i;++i)s[i]=r[i]=1;var o,u=null;if(e.ar){var h=e.tmp;for(e.env.process(h),i=0;a>i;++i)s[i]*=h[i],r[i]*=h[i];u=e.env.emit}else{for(o=e.env.next(),i=0;a>i;++i)s[i]*=o,r[i]*=o;u=e.env.emit}n.outputSignalAR(this),u&&("ended"===u?n.nextTick(e.onended):this._.emit(u,e.value))}return this};var l=function(t){for(var e,i,n,a,o=this._.env,u=[t[0]||f],h=1,l=t.length;l>h;++h)e=t[h][0]||f,i=t[h][1],n=t[h][2],"number"!=typeof i&&(i="string"==typeof i?s(i):10),10>i&&(i=10),"number"==typeof n?(a=n,n=r.CurveTypeCurve):(n=r.CurveTypeDict[n]||null,a=0),u.push([e,i,n,a]);o.setTable(u)},c=t.Object.prototype.plot;h.plot=function(t){if(this._.plotFlush){var e,i,n=this._.env.clone(),s=n.getInfo(1e3),a=s.totalDuration,o=s.loopBeginTime,u=s.releaseBeginTime,h=new Float32Array(256),l=0,f=a/h.length,p=!1,d=.001*a*this._.samplerate|0;for(d/=h.length,n.setStep(d),n.status=r.StatusGate,e=0,i=h.length;i>e;++e)h[e]=n.next(),!p&&(l+=f)>=u&&(n.release(),p=!0);this._.plotData=h,this._.plotBefore=function(t,e,i,n,s){var r,h;1/0!==o&&1/0!==u&&(h=e+n*(u/a),h-=r=e+n*(o/a),t.fillStyle="rgba(224, 224, 224, 0.8)",t.fillRect(r,0,h,s)),1/0!==u&&(h=n-(r=e+n*(u/a)),t.fillStyle="rgba(212, 212, 212, 0.8)",t.fillRect(r,0,h,s))};var m=1/0,v=-1/0;for(e=0;i>e;++e)h[e]<m?m=h[e]:h[e]>v&&(v=h[e]);1>v&&(v=1),this._.plotRange=[m,v],this._.plotData=h,this._.plotFlush=null}return c.call(this,t)},n.register("env",e);var f=r.ZERO;n.register("perc",(function(t){a(t[0])||t.unshift({});var n=t[0],r=i(n,10,10,"a","attackTime",s),o=i(n,10,1e3,"r","releaseTime",s),u=i(n,f,1,"lv","level");return n.table=[f,[u,r],[f,o]],new e(t)})),n.register("adsr",(function(t){a(t[0])||t.unshift({});var n=t[0],r=i(n,10,10,"a","attackTime",s),o=i(n,10,300,"d","decayTime",s),u=i(n,f,.5,"s","sustainLevel"),h=i(n,10,1e3,"r","decayTime",s),l=i(n,f,1,"lv","level");return n.table=[f,[l,r],[u,o],[f,h]],n.releaseNode=3,new e(t)})),n.register("adshr",(function(t){a(t[0])||t.unshift({});var n=t[0],r=i(n,10,10,"a","attackTime",s),o=i(n,10,300,"d","decayTime",s),u=i(n,f,.5,"s","sustainLevel"),h=i(n,10,500,"h","holdTime",s),l=i(n,10,1e3,"r","decayTime",s),c=i(n,f,1,"lv","level");return n.table=[f,[c,r],[u,o],[u,h],[f,l]],new e(t)})),n.register("asr",(function(t){a(t[0])||t.unshift({});var n=t[0],r=i(n,10,10,"a","attackTime",s),o=i(n,f,.5,"s","sustainLevel"),u=i(n,10,1e3,"r","releaseTime",s);return n.table=[f,[o,r],[f,u]],n.releaseNode=2,new e(t)})),n.register("dadsr",(function(t){a(t[0])||t.unshift({});var n=t[0],r=i(n,10,100,"dl","delayTime",s),o=i(n,10,10,"a","attackTime",s),u=i(n,10,300,"d","decayTime",s),h=i(n,f,.5,"s","sustainLevel"),l=i(n,10,1e3,"r","relaseTime",s),c=i(n,f,1,"lv","level");return n.table=[f,[f,r],[c,o],[h,u],[f,l]],n.releaseNode=4,new e(t)})),n.register("ahdsfr",(function(t){a(t[0])||t.unshift({});var n=t[0],r=i(n,10,10,"a","attackTime",s),o=i(n,10,10,"h","holdTime",s),u=i(n,10,300,"d","decayTime",s),h=i(n,f,.5,"s","sustainLevel"),l=i(n,10,5e3,"f","fadeTime",s),c=i(n,10,1e3,"r","relaseTime",s),p=i(n,f,1,"lv","level");return n.table=[f,[p,r],[p,o],[h,u],[f,l],[f,c]],n.releaseNode=5,new e(t)})),n.register("linen",(function(t){a(t[0])||t.unshift({});var n=t[0],r=i(n,10,10,"a","attackTime",s),o=i(n,10,1e3,"s","sustainTime",s),u=i(n,10,1e3,"r","releaseTime",s),h=i(n,f,1,"lv","level");return n.table=[f,[h,r],[h,o],[f,u]],new e(t)})),n.register("env.tri",(function(t){a(t[0])||t.unshift({});var n=t[0],r=i(n,20,1e3,"dur","duration",s),o=i(n,f,1,"lv","level");return r*=.5,n.table=[f,[o,r],[f,r]],new e(t)})),n.register("env.cutoff",(function(t){a(t[0])||t.unshift({});var n=t[0],r=i(n,10,100,"r","relaseTime",s),o=i(n,f,1,"lv","level");return n.table=[o,[f,r]],new e(t)}))}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var n=this._;n.biquads=new Array(7),n.plotBefore=a,n.plotRange=[-18,18],n.plotFlush=!0}var i=t.fn,n=t.modules.FFT,s=t.modules.Biquad,r={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};i.extend(e);var a=function(t,e,i,n,s){t.lineWidth=1,t.strokeStyle="rgb(192, 192, 192)";for(var r=.5*this._.samplerate,a=1;10>=a;++a)for(var o=1;4>=o;o++){var u=a*Math.pow(10,o);if(!(20>=u||u>=r)){t.beginPath();var h=Math.log(u/20)/Math.log(r/20);h=.5+(h*n+e|0),t.moveTo(h,i),t.lineTo(h,i+s),t.stroke()}}var l=s/6;for(a=1;6>a;a++){t.beginPath();var c=.5+(i+a*l|0);t.moveTo(e,c),t.lineTo(e+n,c),t.stroke()}},o=e.prototype;Object.defineProperties(o,{params:{set:function(t){if("object"==typeof t)for(var e=Object.keys(t),i=0,n=e.length;n>i;++i){var s=t[e[i]];Array.isArray(s)?this.setParams(e[i],s[0],s[1],s[2]):this.setParams(e[i])}}}}),o.setParams=function(t,e,i,n){var a=this._;if("string"==typeof t&&(t=r[t]),t>=0&&t<a.biquads.length){if(t|=0,"number"==typeof e&&"number"==typeof i){"number"!=typeof n&&(n=0);var o=a.biquads[t];if(!o)switch(o=a.biquads[t]=new s(a.samplerate),t){case 0:o.setType("highpass");break;case a.biquads.length-1:o.setType("lowpass");break;default:o.setType("peaking")}o.setParams(e,i,n)}else a.biquads[t]=void 0;a.plotFlush=!0}return this},o.getParams=function(t){var e=this._.biquads[0|t];return e?{freq:e.frequency,Q:e.Q,gain:e.gain}:void 0},o.process=function(t){var e=this._;if(this.tickID!==t){if(this.tickID=t,i.inputSignalAR(this),!e.bypassed)for(var n=this.cells[1],s=this.cells[2],r=e.biquads,a=0,o=r.length;o>a;++a)r[a]&&r[a].process(n,s);i.outputSignalAR(this)}return this};var u=new n(2048),h=t.Object.prototype.plot;o.plot=function(t){if(this._.plotFlush){var e=this._,i=new Float32Array(u.length);i[0]=1;for(var n=0,r=e.biquads.length;r>n;++n){var a=this.getParams(n);if(a){var o=new s(e.samplerate);o.setType(0===n?"highpass":n===r-1?"lowpass":"peaking"),o.setParams(a.freq,a.Q,a.gain),o.process(i,i)}}u.forward(i);var l,c,f,p,d=512,m=new Float32Array(d),v=.5*e.samplerate,g=new Float32Array(d);for(u.getFrequencyData(g),n=0;d>n;++n)f=(l=20*Math.pow(v/20,n/d)/(v/g.length))-(c=0|l),0===c?p=g[c]:p=(1-f)*g[c-1]+f*g[c],m[n]=p;this._.plotData=m,this._.plotFlush=null}return h.call(this,t)},i.register("eq",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.listener(this),i.fixAR(this),this.real=new t.ChannelObject(this),this.imag=new t.ChannelObject(this),this.cells[3]=this.real.cell,this.cells[4]=this.imag.cell;var s=this._;s.fft=new n(2*s.cellsize),s.fftCell=new i.SignalArray(s.fft.length),s.prevCell=new i.SignalArray(s.cellsize),s.freqs=new i.SignalArray(s.fft.length>>1),s.plotFlush=!0,s.plotRange=[0,32],s.plotBarStyle=!0}var i=t.fn,n=t.modules.FFT;i.extend(e);var s=e.prototype;Object.defineProperties(s,{window:{set:function(t){this._.fft.setWindow(t)},get:function(){return this._.fft.windowName}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}}}),s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,i.inputSignalAR(this),i.outputSignalAR(this);var n=this.cells[0],s=e.cellsize;e.fftCell.set(e.prevCell),e.fftCell.set(n,s),e.fft.forward(e.fftCell),e.prevCell.set(n),e.plotFlush=!0,this.cells[3].set(e.fft.real.subarray(0,s)),this.cells[4].set(e.fft.imag.subarray(0,s))}return this};var r=t.Object.prototype.plot;s.plot=function(t){return this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null),r.call(this,t)},i.register("fft",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.fixAR(this);var n=this._;n.freq=t(440),n.reg=32768,n.shortFlag=!1,n.phase=0,n.lastValue=0}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{shortFlag:{set:function(t){this._.shortFlag=!!t},get:function(){return this._.shortFlag}},freq:{set:function(e){this._.freq=t(e)},get:function(){return this._.freq}}}),n.process=function(t){var e=this._,i=this.cells[0];if(this.tickID!==t){this.tickID=t;var n,s,r=e.lastValue,a=e.phase,o=e.freq.process(t).cells[0][0]/e.samplerate,u=e.reg,h=e.mul,l=e.add;if(e.shortFlag)for(n=0,s=i.length;s>n;++n)a>=1&&(u>>=1,r=(1&(u|=(1&(u^u>>6))<<15))-.5,a-=1),i[n]=r*h+l,a+=o;else for(n=0,s=i.length;s>n;++n)a>=1&&(u>>=1,r=(1&(u|=(1&(u^u>>1))<<15))-.5,a-=1),i[n]=r*h+l,a+=o;e.reg=u,e.phase=a,e.lastValue=r}return this},i.register("fnoise",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this),this._.selected=0,this._.outputs=[]}var i=t.fn,n=function(){function e(e){t.Object.call(this,2,[]),i.fixAR(this),this._.parent=e}return i.extend(e),e.prototype.process=function(t){return this.tickID!==t&&(this.tickID=t,this._.parent.process(t)),this},e}();i.extend(e);var s=e.prototype;Object.defineProperties(s,{selected:{set:function(t){var e=this._;if("number"==typeof t){e.selected=t;for(var n=e.outputs,s=0,r=n.length;r>s;++s)n[s]&&(n[s].cells[0].set(i.emptycell),n[s].cells[1].set(i.emptycell),n[s].cells[2].set(i.emptycell))}},get:function(){return this._.selected}}}),s.at=function(t){var e=this._,i=e.outputs[t];return i||(e.outputs[t]=i=new n(this)),i},s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,i.inputSignalAR(this),i.outputSignalAR(this);var n=e.outputs[e.selected];n&&(n.cells[0].set(this.cells[0]),n.cells[1].set(this.cells[1]),n.cells[2].set(this.cells[2]))}return this},i.register("gate",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.fixAR(this);var s=this._;s.fft=new n(2*s.cellsize),s.fftCell=new i.SignalArray(this._.fft.length),s.realBuffer=new i.SignalArray(this._.fft.length),s.imagBuffer=new i.SignalArray(this._.fft.length)}var i=t.fn,n=t.modules.FFT;i.extend(e);var s=e.prototype;Object.defineProperties(s,{real:{set:function(e){this._.real=t(e)},get:function(){return this._.real}},imag:{set:function(e){this._.imag=t(e)},get:function(){return this._.imag}}}),s.process=function(t){var e=this._;if(this.tickID!==t&&(this.tickID=t,e.real&&e.imag)){var n=this.cells[0],s=e.realBuffer,r=e.imagBuffer,a=e.real.process(t).cells[0],o=e.imag.process(t).cells[0];s.set(a),r.set(o),n.set(e.fft.inverse(s,r).subarray(0,e.cellsize)),i.outputSignalAR(this)}return this},i.register("ifft",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.timer(this),i.fixKR(this);var n=this._;n.interval=t(1e3),n.count=0,n.delay=0,n.timeout=1/0,n.currentTime=0,n.delaySamples=0,n.countSamples=0,n.onended=i.make_onended(this),this.on("start",s)}var i=t.fn,n=t.timevalue;i.extend(e);var s=function(){var t=this._;this.playbackState=i.PLAYING_STATE,t.delaySamples=.001*t.samplerate*t.delay|0,t.countSamples=t.count=t.currentTime=0};Object.defineProperty(s,"unremovable",{value:!0,writable:!1});var r=e.prototype;Object.defineProperties(r,{interval:{set:function(e){"string"==typeof e&&(0>=(e=n(e))&&(e=0)),this._.interval=t(e)},get:function(){return this._.interval}},delay:{set:function(t){"string"==typeof t&&(t=n(t)),"number"==typeof t&&t>=0&&(this._.delay=t,this._.delaySamples=.001*this._.samplerate*t|0)},get:function(){return this._.delay}},count:{set:function(t){"number"==typeof t&&(this._.count=t)},get:function(){return this._.count}},timeout:{set:function(t){"string"==typeof t&&(t=n(t)),"number"==typeof t&&t>=0&&(this._.timeout=t)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}}),r.bang=function(){var t=this._;return this.playbackState=i.PLAYING_STATE,t.delaySamples=.001*t.samplerate*t.delay|0,t.countSamples=t.count=t.currentTime=0,t.emit("bang"),this},r.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){this.tickID=t,n.delaySamples>0&&(n.delaySamples-=e.length);var s=n.interval.process(t).cells[0][0];if(n.delaySamples<=0&&(n.countSamples-=e.length,n.countSamples<=0)){n.countSamples+=n.samplerate*s*.001|0;for(var r=this.nodes,a=n.count,o=a*n.mul+n.add,u=0,h=e.length;h>u;++u)e[u]=o;for(var l=0,c=r.length;c>l;++l)r[l].bang(a);n.count+=1}n.currentTime+=i.currentTimeIncr,n.currentTime>=n.timeout&&i.nextTick(n.onended)}return this},i.register("interval",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.fixAR(this);var n=this._,s=Math.ceil(Math.log(n.samplerate)*Math.LOG2E);n.buffersize=1<<s,n.buffermask=n.buffersize-1,n.buffer=new i.SignalArray(n.buffersize),n.time=0,n.readIndex=0,n.writeIndex=0}var i=t.fn,n=t.timevalue;i.extend(e);var s=e.prototype;Object.defineProperties(s,{time:{set:function(t){if("string"==typeof t&&(t=n(t)),"number"==typeof t&&t>0){var e=this._;e.time=t;var i=.001*t*e.samplerate|0;i>e.buffermask&&(i=e.buffermask),e.writeIndex=e.readIndex+i&e.buffermask}},get:function(){return this._.time}}}),s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,i.inputSignalAR(this);var n,s=this.cells[0],r=e.buffer,a=e.buffermask,o=e.readIndex,u=e.writeIndex,h=s.length;for(n=0;h>n;++n)r[u]=s[n],s[n]=r[o],o+=1,u=u+1&a;e.readIndex=o&a,e.writeIndex=u,i.outputSignalAR(this)}return this},i.register("lag",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var i=this._;i.input=0,i.value=0,i.prev=null,i.ar=!1,i.map=n}var i=t.fn;i.extend(e);var n=function(t){return t},s=e.prototype;Object.defineProperties(s,{input:{set:function(t){"number"==typeof t&&(this._.input=t)},get:function(){return this._.input}},map:{set:function(t){"function"==typeof t&&(this._.map=t)},get:function(){return this._.map}}}),s.bang=function(){return this._.prev=null,this._.emit("bang"),this},s.at=function(t){return this._.map?this._.map(t):0},s.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){this.tickID=t;var s,r=this.nodes.length,a=e.length;if(n.ar&&r){i.inputSignalAR(this);var o=n.map;if(o)for(s=0;a>s;++s)e[s]=o(e[s]);n.value=e[a-1],i.outputSignalAR(this)}else{var u=r?i.inputSignalKR(this):n.input;n.map&&n.prev!==u&&(n.prev=u,n.value=n.map(u));var h=n.value*n.mul+n.add;for(s=0;a>s;++s)e[s]=h}}return this},i.register("map",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e)}var i=t.fn;i.extend(e),e.prototype.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){this.tickID=t;var s,r,a,o,u=this.nodes,h=u.length,l=e.length;if(n.ar){if(u.length>0)for(a=u[0].process(t).cells[0],e.set(a),s=1;h>s;++s)for(a=u[s].process(t).cells[0],r=0;l>r;++r)o=a[r],e[r]<o&&(e[r]=o);else for(r=0;l>r;++r)e[r]=0;i.outputSignalAR(this)}else{if(u.length>0)for(a=u[0].process(t).cells[0][0],s=1;h>s;++s)(o=u[s].process(t).cells[0][0])>a&&(a=o);else a=0;e[0]=a,i.outputSignalKR(this)}}return this},i.register("max",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var s=this._;s.src=s.func=null,s.bufferL=new i.SignalArray(n),s.bufferR=new i.SignalArray(n),s.readIndex=0,s.writeIndex=0,s.totalRead=0,s.totalWrite=0}if("browser"===t.envtype){var i=t.fn,n=4096,s=n-1;i.extend(e);var r=e.prototype;r.listen=function(e){var i=a[t.env];i&&(i.set.call(this,e),i.listen.call(this))},r.unlisten=function(){var e=a[t.env];e&&e.unlisten.call(this),this.cells[0].set(i.emptycell),this.cells[1].set(i.emptycell),this.cells[2].set(i.emptycell);for(var n=this._,s=n.bufferL,r=n.bufferR,o=0,u=s.length;u>o;++o)s[o]=r[o]=0},r.process=function(t){var e=this._;if(null===e.src)return this;if(this.tickID!==t){this.tickID=t;var n=e.cellsize;if(e.totalWrite>e.totalRead+n){var r=e.readIndex,a=r+n;this.cells[1].set(e.bufferL.subarray(r,a)),this.cells[2].set(e.bufferR.subarray(r,a)),e.readIndex=a&s,e.totalRead+=n}i.outputSignalAR(this)}return this};var a={};a.webkit={set:function(t){var e=this._;if(t instanceof HTMLMediaElement){var n=i._audioContext;e.src=n.createMediaElementSource(t)}},listen:function(){var t=this._,e=i._audioContext;t.gain=e.createGainNode(),t.gain.gain.value=0,t.node=e.createJavaScriptNode(1024,2,2),t.node.onaudioprocess=o(this),t.src.connect(t.node),t.node.connect(t.gain),t.gain.connect(e.destination)},unlisten:function(){var t=this._;t.src&&t.src.disconnect(),t.gain&&t.gain.disconnect(),t.node&&t.node.disconnect()}};var o=function(t){return function(e){var i=t._,n=e.inputBuffer,r=n.length,a=i.writeIndex;i.bufferL.set(n.getChannelData(0),a),i.bufferR.set(n.getChannelData(1),a),i.writeIndex=a+r&s,i.totalWrite+=r}};a.moz={set:function(t){var e=this._;t instanceof HTMLAudioElement&&(e.src=t,e.istep=e.samplerate/t.mozSampleRate)},listen:function(){var t=this._,e=t.bufferL,i=t.bufferR,n=0,r=0;2===t.src.mozChannels?(t.x=0,t.func=function(a){var o,u,h=t.writeIndex,l=t.totalWrite,c=a.frameBuffer,f=t.istep,p=c.length;for(o=t.x,u=0;p>u;u+=2){for(o+=f;o>0;)e[h]=.5*(c[u]+n),i[h]=.5*(c[u+1]+r),h=h+1&s,++l,o-=1;n=c[u],r=c[u+1]}t.x=o,t.writeIndex=h,t.totalWrite=l}):(t.x=0,t.func=function(r){var a,o,u=t.writeIndex,h=t.totalWrite,l=r.frameBuffer,c=t.istep,f=l.length;for(a=t.x,o=0;f>o;++o){for(a+=c;a>=0;)e[u]=i[u]=.5*(l[o]+n),u=u+1&s,++h,a-=1;n=l[o]}t.x=a,t.writeIndex=u,t.totalWrite=h}),t.src.addEventListener("MozAudioAvailable",t.func)},unlisten:function(){var t=this._;t.func&&(t.src.removeEventListener("MozAudioAvailable",t.func),t.func=null)}},i.register("mediastream",e)}}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var i=this._;i.midi=0,i.value=0,i.prev=null,i.a4=440,i.ar=!1}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{midi:{set:function(t){"number"==typeof t&&(this._.midi=t)},get:function(){return this._.midi}},a4:{set:function(t){"number"==typeof t&&(this._.a4=t,this._.prev=null)},get:function(){return this._.a4}}}),n.bang=function(){return this._.prev=null,this._.emit("bang"),this},n.at=function(t){return this._.a4*Math.pow(2,(t-69)/12)},n.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,s=this.cells[0],r=this.nodes.length,a=s.length;if(e.ar&&r){i.inputSignalAR(this);var o=e.a4;for(n=0;a>n;++n)s[n]=o*Math.pow(2,(s[n]-69)/12);e.value=s[a-1],i.outputSignalAR(this)}else{var u=r?i.inputSignalKR(this):e.midi;e.prev!==u&&(e.prev=u,e.value=e.a4*Math.pow(2,(u-69)/12)),s[0]=e.value,i.outputSignalKR(this)}}return this},i.register("midicps",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var i=this._;i.midi=0,i.value=0,i.prev=null,i.range=12,i.ar=!1}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{midi:{set:function(t){"number"==typeof t&&(this._.midi=t)},get:function(){return this._.midi}},range:{set:function(t){"number"==typeof t&&t>0&&(this._.range=t)},get:function(){return this._.range}}}),n.bang=function(){return this._.prev=null,this._.emit("bang"),this},n.at=function(t){var e=this._;return Math.pow(2,t/e.range)},n.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){this.tickID=t;var s,r=this.nodes.length,a=e.length;if(n.ar&&r){i.inputSignalAR(this);var o=n.range;for(s=0;a>s;++s)e[s]=Math.pow(2,e[s]/o);n.value=e[a-1],i.outputSignalAR(this)}else{var u=this.nodes.length?i.inputSignalKR(this):n.midi;n.prev!==u&&(n.prev=u,n.value=Math.pow(2,u/n.range));var h=n.value*n.mul+n.add;for(s=0;a>s;++s)e[s]=h}}return this},i.register("midiratio",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e)}var i=t.fn;i.extend(e),e.prototype.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){this.tickID=t;var s,r,a,o,u=this.nodes,h=u.length,l=e.length;if(n.ar){if(u.length>0)for(a=u[0].process(t).cells[0],e.set(a),s=1;h>s;++s)for(a=u[s].process(t).cells[0],r=0;l>r;++r)o=a[r],e[r]>o&&(e[r]=o);else for(r=0;l>r;++r)e[r]=0;i.outputSignalAR(this)}else{if(u.length>0)for(a=u[0].process(t).cells[0][0],s=1;h>s;++s)a>(o=u[s].process(t).cells[0][0])&&(a=o);else a=0;e[0]=a,i.outputSignalKR(this)}}return this},i.register("min",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,0,e),i.timer(this),i.fixKR(this);var s=this._;s.tracks=[],s.onended=i.make_onended(this),s.currentTime=0,this.on("start",n)}var i=t.fn;i.extend(e);var n=function(){var t=this,e=this._,n=e.mml;"string"==typeof n&&(n=[n]),e.tracks=n.map((function(e,i){return new r(t,i,e)})),e.currentTime=0,this.playbackState=i.PLAYING_STATE};Object.defineProperty(n,"unremoved",{value:!0,writable:!1});var s=e.prototype;Object.defineProperties(s,{mml:{set:function(t){var e=this._;("string"==typeof t||Array.isArray(t))&&(e.mml=t)},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}}}),s.on=s.addListener=function(t,e){return"mml"===t&&(t="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener.")),this._.events.on(t,e),this},s.once=function(t,e){return"mml"===t&&(t="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener.")),this._.events.once(t,e),this},s.off=s.removeListener=function(t,e){return"mml"===t&&(t="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener.")),this._.events.off(t,e),this},s.removeAllListeners=function(t){return"mml"===t&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),t="data"),this._.events.removeAllListeners(t),this},s.listeners=function(t){return"mml"===t&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),t="data"),this._.events.listeners(t)},s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,s,r=e.tracks;for(n=0,s=r.length;s>n;++n)r[n].process();for(;n--;)r[n].ended&&r.splice(n,1);0===r.length&&i.nextTick(e.onended),e.currentTime+=i.currentTimeIncr}return this},i.register("mml",e);var r=function(){function t(t,e,i){var n=this._={};n.sequencer=t,n.trackNum=e,n.commands=a(i),n.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1},n.index=0,n.queue=[],n.currentTime=0,n.queueTime=0,n.segnoIndex=-1,n.loopStack=[],n.prevNote=0,n.remain=1/0,this.ended=!1,r(this)}t.prototype.process=function(){var t=this._,a=t.sequencer,o=t.trackNum,u=t.queue,h=!1;if(u.length)for(;u[0][0]<=t.currentTime;){var l=t.queue.shift();switch(l[1]){case 1:e(a,o,l[2],l[3]),t.remain=l[4],r(this);break;case 2:n(a,o,l[2],l[3]);break;case 3:s(a,l[2]);break;case 0:h=!0}if(0===u.length)break}t.remain-=i.currentTimeIncr,h&&(this.ended=!0),t.currentTime+=i.currentTimeIncr};var e=function(t,e,i,n){var s,r,a,o=t.nodes;for(r=0,a=o.length;a>r;++r)(s=o[r]).noteOn?s.noteOn(i,n):s.bang();t._.emit("data","noteOn",{trackNum:e,noteNum:i,velocity:n})},n=function(t,e,i,n){var s,r,a,o=t.nodes;for(r=0,a=o.length;a>r;++r)(s=o[r]).noteOff?s.noteOff(i,n):s.release&&s.release();t._.emit("data","noteOff",{trackNum:e,noteNum:i,velocity:n})},s=function(t,e){t._.emit("data","command",{command:e})},r=function(t){var e,i,n,s,r,a,o,u,h,l,c,f,p,d=t._,m=(d.sequencer,d.commands),v=d.queue,g=d.index,b=d.status,_=d.queueTime,y=d.loopStack;h=[];t:for(;;){if(m.length<=g){if(!(d.segnoIndex>=0))break;g=d.segnoIndex}switch((e=m[g++]).name){case"@":v.push([_,3,e.val]);break;case"n":if(i=b.t||120,null!==e.len?(s=e.len,r=e.dot||0):(s=b.l,r=e.dot||b.dot),o=60/i*(4/s)*1e3,o*=[1,1.5,1.75,1.875][r]||1,a=b.v<<3,b.tie){for(f=v.length;f--;)if(v[f][2]){v.splice(f,1);break}n=d.prevNote}else n=d.prevNote=e.val+12*(b.o+1),v.push([_,1,n,a,o]);if(s>0){if(1>(u=b.q/8))for(l=_+o*u,v.push([l,2,n,a]),f=0,p=h.length;p>f;++f)v.push([l,2,h[f],a]);if(h=[],_+=o,!b.tie)break t}else h.push(n);b.tie=!1;break;case"r":i=b.t||120,null!==e.len?(s=e.len,r=e.dot||0):(s=b.l,r=e.dot||b.dot),s>0&&(o=60/i*(4/s)*1e3,_+=o*=[1,1.5,1.75,1.875][r]||1);break;case"l":b.l=e.val,b.dot=e.dot;break;case"o":b.o=e.val;break;case"<":b.o<9&&(b.o+=1);break;case">":b.o>0&&(b.o-=1);break;case"v":b.v=e.val;break;case"(":b.v<15&&(b.v+=1);break;case")":b.v>0&&(b.v-=1);break;case"q":b.q=e.val;break;case"&":b.tie=!0;break;case"$":d.segnoIndex=g;break;case"[":y.push([g,null,null]);break;case"|":(c=y[y.length-1])&&1===c[1]&&(y.pop(),g=c[2]);break;case"]":(c=y[y.length-1])&&(null===c[1]&&(c[1]=e.count,c[2]=g),c[1]-=1,0===c[1]?y.pop():g=c[0]);break;case"t":b.t=null===e.val?120:e.val;break;case"EOF":v.push([_,0])}}d.index=g,d.queueTime=_},a=function(t){var e,i,n,s,r,a,u,h,l=new Array(t.length),c=[];for(r=0,a=o.length;a>r;++r)for(i=(e=o[r]).re;n=i.exec(t);){if(!l[n.index]){for(u=0,h=n[0].length;h>u;++u)l[n.index+u]=!0;(s=e.func?e.func(n):{name:n[0]})&&(s.index=n.index,s.origin=n[0],c.push(s))}for(;i.lastIndex<t.length&&l[i.lastIndex];)++i.lastIndex}return c.sort((function(t,e){return t.index-e.index})),c.push({name:"EOF"}),c},o=[{re:/@(\d*)/g,func:function(t){return{name:"@",val:t[1]||null}}},{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,func:function(t){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[t[1]]+({"-":-1,"+":1}[t[2]]||0),len:""===t[3]?null:Math.min(0|t[3],64),dot:t[4].length}}},{re:/r(\d*)(\.*)/g,func:function(t){return{name:"r",len:""===t[1]?null:Math.max(1,Math.min(0|t[1],64)),dot:t[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(t){return{name:"l",val:""===t[1]?4:Math.min(0|t[1],64),dot:t[2].length}}},{re:/o([0-9])/g,func:function(t){return{name:"o",val:""===t[1]?4:0|t[1]}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(t){return{name:"v",val:""===t[1]?12:Math.min(0|t[1],15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(t){return{name:"q",val:""===t[1]?6:Math.min(0|t[1],8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(t){return{name:"]",count:0|t[1]||2}}},{re:/t(\d*)/g,func:function(t){return{name:"t",val:""===t[1]?null:Math.max(5,Math.min(0|t[1],300))}}},{re:/\$/g}];return t}()}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e)}var i=t.fn;i.extend(e),e.prototype.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.ar?(i.inputSignalAR(this),i.outputSignalAR(this)):(this.cells[0][0]=i.inputSignalKR(this),i.outputSignalKR(this))),this},i.register("mono",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e)}var i=t.fn;i.extend(e),e.prototype.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,s,r,a,o,u=this.nodes,h=this.cells[0],l=this.cells[1],c=this.cells[2],f=u.length,p=h.length;if(e.ar){if(u.length>0)for(u[0].process(t),a=u[0].cells[1],o=u[0].cells[2],l.set(a),c.set(o),n=1;f>n;++n)for(u[n].process(t),a=u[n].cells[1],o=u[n].cells[2],s=0;p>s;++s)l[s]*=a[s],c[s]*=o[s];else for(s=0;p>s;++s)l[s]=c[s]=0;i.outputSignalAR(this)}else{if(u.length>0)for(r=u[0].process(t).cells[0][0],n=1;f>n;++n)r*=u[n].process(t).cells[0][0];else r=0;h[0]=r,i.outputSignalKR(this)}}return this},i.register("*",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var i=this._;i.defaultValue=0,i.index=0,i.dict={},i.ar=!1}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{dict:{set:function(t){if("object"==typeof t)this._.dict=t;else if("function"==typeof t){for(var e={},i=0;128>i;++i)e[i]=t(i);this._.dict=e}},get:function(){return this._.dict}},defaultValue:{set:function(t){"number"==typeof t&&(this._.defaultValue=t)},get:function(){return this._.defaultValue}},index:{set:function(t){"number"==typeof t&&(this._.index=t)},get:function(){return this._.index}}}),n.at=function(t){var e=this._;return(e.dict[0|t]||e.defaultValue)*e.mul+e.add},n.clear=function(){return this._.dict={},this},n.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){this.tickID=t;var s,r,a,o=this.nodes.length,u=n.dict,h=n.defaultValue,l=n.mul,c=n.add,f=e.length;if(n.ar&&o){for(i.inputSignalAR(this),a=0;f>a;++a)s=0>(s=e[a])?s-.5|0:s+.5|0,e[a]=(u[s]||h)*l+c;i.outputSignalAR(this)}else for(r=(u[s=0>(s=this.nodes.length?i.inputSignalKR(this):n.index)?s-.5|0:s+.5|0]||h)*l+c,a=0;f>a;++a)e[a]=r}return this},i.register("ndict",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e)}var i=t.fn;i.extend(e),e.prototype.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var n,s,r,a=i.mul,o=i.add;if(i.ar)for(n=0,s=e.length;s>n;++n)e[n]=(2*Math.random()-1)*a+o;else for(r=(2*Math.random()+1)*a+o,n=0,s=e.length;s>n;++n)e[n]=r}return this},i.register("noise",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e);var n=this._;n.freq=t(440),n.phase=t(0),n.osc=new s(n.samplerate),n.tmp=new i.SignalArray(n.cellsize),n.osc.step=n.cellsize,this.once("init",a)}var i=t.fn,n=t.timevalue,s=t.modules.Oscillator;i.extend(e);var r,a=function(){var t=this._;this.wave||(this.wave="sin"),t.plotData=t.osc.wave,t.plotLineWidth=2,t.plotCyclic=!0,t.plotBefore=r},o=e.prototype;Object.defineProperties(o,{wave:{set:function(t){this._.osc.setWave(t)},get:function(){return this._.osc.wave}},freq:{set:function(e){"string"==typeof e&&(e=0>=(e=n(e))?0:1e3/e),this._.freq=t(e)},get:function(){return this._.freq}},phase:{set:function(e){this._.phase=t(e),this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(e){this._.phase=t(e),this._.osc.feedback=!0},get:function(){return this._.phase}}}),o.clone=function(){var t=i.clone(this);return t._.osc=this._.osc.clone(),t._.freq=this._.freq,t._.phase=this._.phase,t},o.bang=function(){return this._.osc.reset(),this._.emit("bang"),this},o.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,s=this.cells[1],r=this.cells[2],a=e.cellsize;if(this.nodes.length)i.inputSignalAR(this);else for(n=0;a>n;++n)s[n]=r[n]=1;var o=e.osc,u=e.freq.process(t).cells[0],h=e.phase.process(t).cells[0];if(o.frequency=u[0],o.phase=h[0],e.ar){var l=e.tmp;for(e.freq.isAr?e.phase.isAr?o.processWithFreqAndPhaseArray(l,u,h):o.processWithFreqArray(l,u):e.phase.isAr?o.processWithPhaseArray(l,h):o.process(l),n=0;a>n;++n)s[n]*=l[n],r[n]*=l[n]}else{var c=o.next();for(n=0;a>n;++n)s[n]*=c,r[n]*=c}i.outputSignalAR(this)}return this},"browser"===t.envtype&&(r=function(t,e,i,n,s){var r=.5+(s>>1);t.strokeStyle="#ccc",t.lineWidth=1,t.beginPath(),t.moveTo(e,r+i),t.lineTo(e+n,r+i),t.stroke()}),i.register("osc",e),i.register("sin",(function(t){return new e(t).set("wave","sin")})),i.register("cos",(function(t){return new e(t).set("wave","cos")})),i.register("pulse",(function(t){return new e(t).set("wave","pulse")})),i.register("tri",(function(t){return new e(t).set("wave","tri")})),i.register("saw",(function(t){return new e(t).set("wave","saw")})),i.register("fami",(function(t){return new e(t).set("wave","fami")})),i.register("konami",(function(t){return new e(t).set("wave","konami")})),i.register("+sin",(function(t){return new e(t).set("wave","+sin").kr()})),i.register("+pulse",(function(t){return new e(t).set("wave","+pulse").kr()})),i.register("+tri",(function(t){return new e(t).set("wave","+tri").kr()})),i.register("+saw",(function(t){return new e(t).set("wave","+saw").kr()})),i.alias("square","pulse")}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var n=this._;n.pos=t(0),n.panL=.5,n.panR=.5}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{pos:{set:function(e){this._.pos=t(e)},get:function(){return this._.pos}}}),n.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n=e.pos.process(t).cells[0][0];e.prevPos!==n&&(e.panL=1-n,e.panR=e.prevPos=n);var s,r,a,o=this.nodes,u=this.cells[1],h=this.cells[2],l=o.length,c=u.length;if(l){for(a=o[0].process(t).cells[0],r=0;c>r;++r)u[r]=h[r]=a[r];for(s=1;l>s;++s)for(a=o[s].process(t).cells[0],r=0;c>r;++r)u[r]=h[r]+=a[r];var f=e.panL,p=e.panR;for(r=0;c>r;++r)u[r]=u[r]*f,h[r]=h[r]*p}else u.set(i.emptycell),h.set(i.emptycell);i.outputSignalAR(this)}return this},i.register("pan",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e);var i=this._;i.value=0,i.env=new r(i.samplerate),i.env.step=i.cellsize,i.curve="lin",i.counter=0,i.ar=!1,i.onended=a(this),this.on("ar",o)}var i=t.fn,n=t.timevalue,s=t.modules.Envelope,r=t.modules.EnvelopeValue;i.extend(e);var a=function(t,e){return function(){if("number"==typeof e)for(var i=t.cells[0],n=t.cells[1],s=t.cells[2],r=t._.env.value,a=0,o=n.length;o>a;++a)i[0]=n[a]=s[a]=r;t._.emit("ended")}},o=function(t){this._.env.step=t?1:this._.cellsize},u=e.prototype;Object.defineProperties(u,{value:{set:function(t){"number"==typeof t&&(this._.env.value=t)},get:function(){return this._.env.value}}}),u.to=function(t,e,i){var r=this._,a=r.env;if("string"==typeof e?e=n(e):void 0===e&&(e=0),void 0===i)r.counter=a.setNext(t,e,s.CurveTypeLin),r.curve="lin";else{var o=s.CurveTypeDict[i];r.counter=void 0===o?a.setNext(t,e,s.CurveTypeCurve,i):a.setNext(t,e,o),r.curve=i}return r.plotFlush=!0,this},u.setAt=function(t,e){var i=this._;return this.to(i.env.value,e,"set"),i.atValue=t,this},u.linTo=function(t,e){return this.to(t,e,"lin")},u.expTo=function(t,e){return this.to(t,e,"exp")},u.sinTo=function(t,e){return this.to(t,e,"sin")},u.welTo=function(t,e){return this.to(t,e,"wel")},u.sqrTo=function(t,e){return this.to(t,e,"sqr")},u.cubTo=function(t,e){return this.to(t,e,"cub")},u.cancel=function(){var t=this._;return t.counter=t.env.setNext(t.env.value,0,s.CurveTypeSet),this},u.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,r,a=this.cells[1],o=this.cells[2],u=e.cellsize,h=e.env,l=e.counter;if(this.nodes.length)i.inputSignalAR(this);else for(n=0;u>n;++n)a[n]=o[n]=1;if(0>=l&&("set"===e.curve?h.setNext(e.atValue,0,s.CurveTypeSet):h.setNext(h.value,0,s.CurveTypeSet),i.nextTick(e.onended),e.counter=1/0),e.ar){for(n=0;u>n;++n)r=h.next(),a[n]*=r,o[n]*=r;e.counter-=e.cellsize}else{for(r=h.next(),n=0;u>n;++n)a[n]*=r,o[n]*=r;e.counter-=1}i.outputSignalAR(this),e.value=r}return this};var h=t.Object.prototype.plot;u.plot=function(t){var e=this._;if(e.plotFlush){var i,n,a,o=new r(128),u=new Float32Array(128);if("set"===e.curve)for(n=100,a=u.length;a>n;++n)u[n]=1;else for(void 0===(i=s.CurveTypeDict[e.curve])?o.setNext(1,1e3,s.CurveTypeCurve,e.curve):o.setNext(1,1e3,i),n=0,a=u.length;a>n;++n)u[n]=o.next();e.plotData=u,e.plotRange=[0,1],e.plotFlush=null}return h.call(this,t)},i.register("param",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var n=this._;n.freq=t("sin",{freq:1,add:1e3,mul:250}).kr(),n.Q=t(1),n.allpass=[],this.steps=2}var i=t.fn,n=t.modules.Biquad;i.extend(e);var s=e.prototype;Object.defineProperties(s,{freq:{set:function(t){this._.freq=t},get:function(){return this._.freq}},Q:{set:function(e){this._.Q=t(e)},get:function(){return this._.Q}},steps:{set:function(t){if("number"==typeof t){if(2===(t|=0)||4===t||8===t||12===t){var e=this._.allpass;if(e.length<t)for(var i=e.length;t>i;++i)e[i]=new n(this._.samplerate),e[i].setType("allpass")}this._.steps=t}},get:function(){return this._.steps}}}),s.process=function(t){var e=this._;if(this.tickID!==t){if(this.tickID=t,i.inputSignalAR(this),!e.bypassed){var n,s=this.cells[1],r=this.cells[2],a=e.freq.process(t).cells[0][0],o=e.Q.process(t).cells[0][0],u=e.steps;for(n=0;u>n;n+=2)e.allpass[n].setParams(a,o,0),e.allpass[n].process(s,r),e.allpass[n+1].setParams(a,o,0),e.allpass[n+1].process(s,r)}i.outputSignalAR(this)}return this},i.register("phaser",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.fixAR(this);for(var n=new Uint8Array(5),s=0;5>s;++s)n[s]=(Math.random()*(1<<30)|0)%25;this._.whites=n,this._.key=0}var i=t.fn;i.extend(e),e.prototype.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var n,s,r,a,o,u,h=i.key,l=i.whites,c=i.mul,f=i.add;for(n=0,s=e.length;s>n;++n){for(a=h++,h>31&&(h=0),u=a^h,r=o=0;5>r;++r)u&1<<r&&(l[r]=(Math.random()*(1<<30)|0)%25),o+=l[r];e[n]=(.01666666*o-1)*c+f}i.key=h}return this},i.register("pink",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),this._.freq=440,this._.buffer=null,this._.index=0}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{freq:{set:function(t){"number"==typeof t&&(0>t&&(t=0),this._.freq=t)},get:function(){return this._.freq}}}),n.bang=function(){for(var t=this._,e=t.freq,n=t.samplerate/e+.5|0,s=t.buffer=new i.SignalArray(n),r=0;n>r;++r)s[r]=2*Math.random()-1;return t.index=0,t.emit("bang"),this},n.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var n=i.buffer;if(n){var s,r,a,o=n.length,u=i.index,h=i.mul,l=i.add,c=e.length;for(a=0;c>a;++a)s=u,r=n[u++],u>=o&&(u=0),r=.5*(r+n[u]),n[s]=r,e[a]=r*h+l;i.index=u}}return this},i.register("pluck",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.listener(this),i.fixAR(this);var n=this._;n.timeout=5e3,n.status=s,n.writeIndex=0,n.writeIndexIncr=1,n.currentTime=0,n.currentTimeIncr=1e3/n.samplerate,n.onended=r(this)}var i=t.fn,n=t.timevalue,s=0;i.extend(e);var r=function(t){return function(){var e=t._,n=new i.SignalArray(e.buffer.subarray(0,0|e.writeIndex));e.status=s,e.writeIndex=0,e.currentTime=0,e.emit("ended",{buffer:n,samplerate:e.samplerate})}},a=e.prototype;Object.defineProperties(a,{timeout:{set:function(t){"string"==typeof t&&(t=n(t)),"number"==typeof t&&t>0&&(this._.timeout=t)},get:function(){return this._.timeout}},samplerate:{set:function(t){"number"==typeof t&&t>0&&t<=this._.samplerate&&(this._.samplerate=t)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}}),a.start=function(){var e,n=this._;return n.status===s&&(e=.01*n.timeout*n.samplerate|0,(!n.buffer||n.buffer.length<e)&&(n.buffer=new i.SignalArray(e)),n.writeIndex=0,n.writeIndexIncr=n.samplerate/t.samplerate,n.currentTime=0,n.status=1,n.emit("start"),this.listen()),this},a.stop=function(){var t=this._;return 1===t.status&&(t.status=s,t.emit("stop"),i.nextTick(t.onended),this.unlisten()),this},a.bang=function(){return this._.status===s?this.srart():1===this._.status&&this.stop(),this._.emit("bang"),this},a.process=function(t){var e=this._,n=this.cells[0];if(this.tickID!==t){if(this.tickID=t,i.inputSignalAR(this),1===e.status){var s,r=n.length,a=e.buffer,o=e.timeout,u=e.writeIndex,h=e.writeIndexIncr,l=e.currentTime,c=e.currentTimeIncr;for(s=0;r>s;++s)a[0|u]=n[s],u+=h,(l+=c)>=o&&i.nextTick(e.onended);e.writeIndex=u,e.currentTime=l}i.outputSignalAR(this)}return this},i.register("record",e),i.alias("rec","record")}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this),this._.reverb=new n(this._.samplerate,this._.cellsize)}var i=t.fn,n=t.modules.Reverb;i.extend(e);var s=e.prototype;Object.defineProperties(s,{room:{set:function(t){"number"==typeof t&&(t=t>1?1:0>t?0:t,this._.reverb.setRoomSize(t))},get:function(){return this._.reverb.roomsize}},damp:{set:function(t){"number"==typeof t&&(t=t>1?1:0>t?0:t,this._.reverb.setDamp(t))},get:function(){return this._.reverb.damp}},mix:{set:function(t){"number"==typeof t&&(t=t>1?1:0>t?0:t,this._.reverb.wet=t)},get:function(){return this._.reverb.wet}}}),s.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,i.inputSignalAR(this),e.bypassed||e.reverb.process(this.cells[1],this.cells[2]),i.outputSignalAR(this)),this},i.register("reverb",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,0,e),i.timer(this),i.fixKR(this);var n=this._;n.queue=[],n.currentTime=0,n.maxRemain=1e3}var i=t.fn,n=t.timevalue;i.extend(e);var s=e.prototype;Object.defineProperties(s,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(t){"number"==typeof t&&t>0&&(this._.maxRemain=t)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}}),s.sched=function(t,e,i){return"string"==typeof t&&(t=n(t)),"number"==typeof t&&this.schedAbs(this._.currentTime+t,e,i),this},s.schedAbs=function(e,i,s){if("string"==typeof e&&(e=n(e)),"number"==typeof e){var r=this._,a=r.queue;if(a.length>=r.maxRemain)return this;for(var o=a.length;o--&&!(a[o][0]<e););a.splice(o+1,0,[e,t(i),s])}return this},s.advance=function(t){return"string"==typeof t&&(t=n(t)),"number"==typeof t&&(this._.currentTime+=t),this},s.clear=function(){return this._.queue.splice(0),this},s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n=null,s=e.queue;if(s.length)for(;s[0][0]<e.currentTime;){var r=e.queue.shift();if(r[1].bang(r[2]),n="sched",0===s.length){n="empty";break}}e.currentTime+=i.currentTimeIncr,n&&e.emit(n)}return this},i.register("schedule",e),i.alias("sched","schedule")}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.listener(this),i.fixAR(this);var n=this._;n.samples=0,n.writeIndex=0,n.plotFlush=!0,this.once("init",s)}var i=t.fn,n=t.timevalue;i.extend(e);var s=function(){this._.buffer||(this.size=1024),this._.interval||(this.interval=1e3)},r=e.prototype;Object.defineProperties(r,{size:{set:function(t){var e=this._;if(!e.buffer&&"number"==typeof t){var n=64>t?64:t>2048?2048:t;e.buffer=new i.SignalArray(n),e.reservedinterval&&(this.interval=e.reservedinterval,e.reservedinterval=null)}},get:function(){return this._.buffer.length}},interval:{set:function(t){var e=this._;"string"==typeof t&&(t=n(t)),"number"==typeof t&&t>0&&(e.buffer?(e.interval=t,e.samplesIncr=.001*t*e.samplerate/e.buffer.length,e.samplesIncr<1&&(e.samplesIncr=1)):e.reservedinterval=t)},get:function(){return this._.interval}},buffer:{get:function(){return this._.buffer}}}),r.bang=function(){for(var t=this._,e=t.buffer,i=0,n=e.length;n>i;++i)e[i]=0;return t.samples=0,t.writeIndex=0,this._.emit("bang"),this},r.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,i.inputSignalAR(this),i.outputSignalAR(this);var n,s=this.cells[0],r=e.cellsize,a=e.samples,o=e.samplesIncr,u=e.buffer,h=e.writeIndex,l=!1,c=u.length;for(n=0;r>n;++n)0>=a&&(u[h++]=s[n],h>=c&&(h=0),l=e.plotFlush=!0,a+=o),--a;e.samples=a,e.writeIndex=h,l&&this._.emit("data")}return this};var a=t.Object.prototype.plot;r.plot=function(t){var e=this._;if(e.plotFlush){for(var i=e.buffer,n=i.length-1,s=new Float32Array(i.length),r=e.writeIndex,o=0,u=i.length;u>o;o++)s[o]=i[++r&n];e.plotData=s,e.plotFlush=null}return a.call(this,t)},i.register("scope",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),s.fixAR(this);var i=this._;i.numberOfInputs=0,i.numberOfOutputs=0,i.bufferSize=0,i.bufferMask=0,i.duration=0,i.inputBufferL=null,i.inputBufferR=null,i.outputBufferL=null,i.outputBufferR=null,i.onaudioprocess=null,i.index=0,this.once("init",r)}function i(t,e){this.samplerate=t._.samplerate,this.length=t._.bufferSize,this.duration=t._.duration,this.numberOfChannels=e.length,this.getChannelData=function(t){return e[t]}}function n(e){var n=e._;this.node=e,this.playbackTime=t.currentTime,this.inputBuffer=2===n.numberOfInputs?new i(e,[n.inputBufferL,n.inputBufferR]):new i(e,[n.inputBufferL]),this.outputBuffer=2===n.numberOfOutputs?new i(e,[n.outputBufferL,n.outputBufferR]):new i(e,[n.outputBufferL])}var s=t.fn;s.extend(e);var r=function(){var t=this._;0===t.numberOfInputs&&(this.numberOfInputs=1),0===t.numberOfOutputs&&(this.numberOfOutputs=1),0===t.bufferSize&&(this.bufferSize=1024)},a=e.prototype;Object.defineProperties(a,{numberOfInputs:{set:function(t){var e=this._;0===e.numberOfInputs&&(e.numberOfInputs=2===t?2:1)},get:function(){return this._.numberOfInputs}},numberOfOutputs:{set:function(t){var e=this._;0===e.numberOfOutputs&&(e.numberOfOutputs=2===t?2:1)},get:function(){return this._.numberOfOutputs}},bufferSize:{set:function(t){var e=this._;0===e.bufferSize&&-1!==[256,512,1024,2048,4096,8192,16384].indexOf(t)&&(e.bufferSize=t,e.bufferMask=t-1,e.duration=t/e.samplerate,e.inputBufferL=new s.SignalArray(t),e.inputBufferR=new s.SignalArray(t),e.outputBufferL=new s.SignalArray(t),e.outputBufferR=new s.SignalArray(t))},get:function(){return this._.bufferSize}},onaudioprocess:{set:function(t){"function"==typeof t&&(this._.onaudioprocess=t)},get:function(){return this._.onaudioprocess}}}),a.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,r=e.cellsize,a=e.bufferMask,o=e.index,u=o+r,h=this.cells[1],l=this.cells[2];if(s.inputSignalAR(this),2===e.numberOfInputs)e.inputBufferL.set(h,o),e.inputBufferR.set(l,o);else{i=e.inputBufferL;for(var c=0;r>c;c++)i[o+c]=.5*(h[c]+l[c])}h.set(e.outputBufferL.subarray(o,u)),l.set(e.outputBufferR.subarray(o,u)),e.index=u&a,0===e.index&&e.onaudioprocess&&(e.onaudioprocess(new n(this)),1===e.numberOfOutputs&&e.outputBufferR.set(e.outputBufferL)),s.outputSignalAR(this)}return this},s.register("script",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),this._.selected=0,this._.background=!1}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{selected:{set:function(t){"number"==typeof t&&(this._.selected=t,this.cells[1].set(i.emptycell),this.cells[2].set(i.emptycell))},get:function(){return this._.selected}},background:{set:function(t){this._.background=!!t},get:function(){return this._.background}}}),n.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,s=this.nodes,r=s.length;if(e.background)for(n=0;r>n;++n)s[n].process(t);var a=s[e.selected];a&&(e.background||a.process(t),this.cells[1].set(a.cells[1]),this.cells[2].set(a.cells[2])),i.outputSignalAR(this)}return this},i.register("selector",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.listener(this),i.fixAR(this);var n=this._;n.status=r,n.samples=0,n.samplesIncr=0,n.writeIndex=0,n.plotFlush=!0,n.plotRange=[0,32],n.plotBarStyle=!0,this.once("init",a)}var i=t.fn,n=t.timevalue,s=t.modules.FFT,r=0;i.extend(e);var a=function(){var t=this._;t.fft||(this.size=512),t.interval||(this.interval=500)},o=e.prototype;Object.defineProperties(o,{size:{set:function(t){var e=this._;if(!e.fft&&"number"==typeof t){var n=256>t?256:t>2048?2048:t;e.fft=new s(n),e.buffer=new i.SignalArray(e.fft.length),e.freqs=new i.SignalArray(e.fft.length>>1),e.reservedwindow&&(e.fft.setWindow(e.reservedwindow),e.reservedwindow=null),e.reservedinterval&&(this.interval=e.reservedinterval,e.reservedinterval=null)}},get:function(){return this._.buffer.length}},window:{set:function(t){this._.fft.setWindow(t)},get:function(){return this._.fft.windowName}},interval:{set:function(t){var e=this._;"string"==typeof t&&(t=n(t)),"number"==typeof t&&t>0&&(e.buffer?(e.interval=t,e.samplesIncr=.001*t*e.samplerate,e.samplesIncr<e.buffer.length&&(e.samplesIncr=e.buffer.length,e.interval=1e3*e.samplesIncr/e.samplerate)):e.reservedinterval=t)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}}),o.bang=function(){return this._.samples=0,this._.writeIndex=0,this._.emit("bang"),this},o.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,i.inputSignalAR(this),i.outputSignalAR(this);var n,s,a=this.cells[0],o=a.length,u=e.status,h=e.samples,l=e.samplesIncr,c=e.writeIndex,f=e.buffer,p=f.length;for(n=0;o>n;++n)0>=h&&u===r&&(u=1,c=0,h+=l),1===u&&(f[c++]=a[n],c>=p&&(e.fft.forward(f),s=e.plotFlush=!0,u=r)),--h;e.samples=h,e.status=u,e.writeIndex=c,s&&this._.emit("data")}return this};var u=t.Object.prototype.plot;o.plot=function(t){return this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null),u.call(this,t)},i.register("spectrum",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),this._.ar=!1}var i=t.fn;i.extend(e),e.prototype.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n,s,r,a,o,u=this.nodes,h=this.cells[0],l=this.cells[1],c=this.cells[2],f=u.length,p=h.length;if(e.ar){if(u.length>0)for(u[0].process(t),a=u[0].cells[1],o=u[0].cells[2],l.set(a),c.set(o),n=1;f>n;++n)for(u[n].process(t),a=u[n].cells[1],o=u[n].cells[2],s=0;p>s;++s)l[s]-=a[s],c[s]-=o[s];else for(s=0;p>s;++s)l[s]=c[n]=0;i.outputSignalAR(this)}else{if(u.length>0)for(r=u[0].process(t).cells[0][0],n=1;f>n;++n)r-=u[n].process(t).cells[0][0];else r=0;h[0]=r,i.outputSignalKR(this)}}return this},i.register("-",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var n=this._;this.playbackState=i.FINISHED_STATE,n.poly=4,n.genList=[],n.genDict={},n.synthdef=null,n.remGen=r(this),n.onended=i.make_onended(this)}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{def:{set:function(t){"function"==typeof t&&(this._.synthdef=t)},get:function(){return this._.synthdef}},poly:{set:function(t){"number"==typeof t&&t>0&&64>=t&&(this._.poly=t)},get:function(){return this._.poly}}});var s=function(t,e){return function(){t._.remGen(e.gen)}},r=function(t){return function(e){var i=t._,n=i.genList.indexOf(e);-1!==n&&i.genList.splice(n,1),void 0!==e.noteNum&&(i.genDict[e.noteNum]=null)}},a=function(e,n,r,a){0>=(r|=0)?this.noteOff(this,e):r>127&&(r=127);var o=this._,u=o.genList,h=o.genDict,l=h[e];l&&o.remGen(l);var c={freq:n,noteNum:e,velocity:r,mul:.0078125*r};if(a)for(var f in a)c[f]=a[f];c.doneAction=s(this,c),(l=o.synthdef.call(this,c))instanceof t.Object&&(l.noteNum=e,u.push(l),h[e]=c.gen=l,this.playbackState=i.PLAYING_STATE,u.length>o.poly&&o.remGen(u[0]))},o=function(){for(var t=new Float32Array(128),e=0;128>e;++e)t[e]=440*Math.pow(2,1*(e-69)/12);return t}(),u=function(t){return t>0?Math.log(1*t/440)*Math.LOG2E*12+69:0};n.noteOn=function(t,e,i){var n=o[t]||440*Math.pow(2,(t-69)/12);return a.call(this,t+.5|0,n,e,i),this},n.noteOff=function(t){var e=this._.genDict[t];return e&&e.release&&e.release(),this},n.noteOnWithFreq=function(t,e,i){var n=u(t);return a.call(this,n+.5|0,t,e,i),this},n.noteOffWithFreq=function(t){var e=u(t);return this.noteOff(e+.5|0)},n.allNoteOff=function(){for(var t=this._.genList,e=0,i=t.length;i>e;++e)t[e].release&&t[e].release()},n.allSoundOff=function(){for(var t=this._,e=t.genList,i=t.genDict;e.length;)delete i[e.shift().noteNum]},n.synth=function(e){var n,r=this._,a=r.genList,o={};if(e)for(var u in e)o[u]=e[u];return o.doneAction=s(this,o),(n=r.synthdef.call(this,o))instanceof t.Object&&(a.push(n),o.gen=n,this.playbackState=i.PLAYING_STATE,a.length>r.poly&&r.remGen(a[0])),this},n.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){if(this.tickID=t,this.playbackState===i.PLAYING_STATE){var s,r,a,o,u,h,l=n.genList,c=this.cells[1],f=this.cells[2],p=e.length;if(l.length)for((s=l[0]).process(t),c.set(s.cells[1]),f.set(s.cells[2]),r=1,a=l.length;a>r;++r)for((s=l[r]).process(t),u=s.cells[1],h=s.cells[2],o=0;p>o;++o)c[o]+=u[o],f[o]+=h[o];else i.nextTick(n.onended)}i.outputSignalAR(this)}return this},i.register("SynthDef",e);var h={set:function(e){i.isDictionary(e)?"string"==typeof e.type&&(this._.env=e):e instanceof t.Object&&(this._.env=e)},get:function(){return this._.env}};i.register("OscGen",function(){var i={set:function(e){e instanceof t.Object&&(this._.osc=e)},get:function(){return this._.osc}},n={set:function(t){"string"==typeof t&&(this._.wave=t)},get:function(){return this._.wave}},s=function(e){var i,n,s,r,a=this._;return n=a.osc||null,r=(s=a.env||{}).type||"perc",n instanceof t.Object&&"function"==typeof n.clone&&(n=n.clone()),n||(n=t("osc",{wave:a.wave})),n.freq=e.freq,n.mul=n.mul*e.velocity/128,i=n,s instanceof t.Object?"function"==typeof s.clone&&(i=s.clone().append(i)):i=t(r,s,i),i.on("ended",e.doneAction).bang(),i};return function(t){var r=new e(t);return r._.wave="sin",Object.defineProperties(r,{env:h,osc:i,wave:n}),r.def=s,r}}()),i.register("PluckGen",function(){var i=function(e){var i,n,s;return s=(n=this._.env||{}).type||"perc",i=t("pluck",{freq:e.freq,mul:e.velocity/128}).bang(),n instanceof t.Object?"function"==typeof n.clone&&(i=n.clone().append(i)):i=t(s,n,i),i.on("ended",e.doneAction).bang(),i};return function(t){var n=new e(t);return Object.defineProperties(n,{env:h}),n.def=i,n}}())}(timbre),function(t){"use strict";function e(e){t.Object.call(this,2,e),i.fixAR(this);var n=this._;n.isLooped=!1,n.onended=i.make_onended(this,0)}var i=t.fn,n=t.modules.Scissor,s=n.Tape,r=n.TapeStream,a=i.isSignalArray;i.extend(e);var o=e.prototype;Object.defineProperties(o,{tape:{set:function(e){e instanceof s?(this.playbackState=i.PLAYING_STATE,this._.tape=e,this._.tapeStream=new r(e,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped):(e instanceof t.Object&&e.buffer&&(e=e.buffer),"object"==typeof e&&Array.isArray(e.buffer)&&a(e.buffer[0])&&(this.playbackState=i.PLAYING_STATE,this._.tape=new n(e),this._.tapeStream=new r(this._.tape,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped))},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}},buffer:{get:function(){return this._.tape?this._.tape.getBuffer():void 0}}}),o.loop=function(t){return this._.isLooped=!!t,this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped),this},o.bang=function(){return this.playbackState=i.PLAYING_STATE,this._.tapeStream&&this._.tapeStream.reset(),this._.emit("bang"),this},o.getBuffer=function(){return this._.tape?this._.tape.getBuffer():void 0},o.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var n=e.tapeStream;if(n){var s=this.cells[1],r=this.cells[2],a=n.fetch(s.length);s.set(a[0]),r.set(a[1]),this.playbackState===i.PLAYING_STATE&&n.isEnded&&i.nextTick(e.onended)}i.outputSignalAR(this)}return this},i.register("tape",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.timer(this);var n=this._;this.playbackState=i.FINISHED_STATE,n.task=[],n.i=0,n.j=0,n.imax=0,n.jmax=0,n.wait=0,n.count=0,n.args={},n.doNum=1,n.initFunc=i.nop,n.onended=a(this),this.on("start",r)}var i=t.fn,n=t.timevalue,s=t((function(){})).constructor;i.extend(e);var r=function(){var t,e=this._;this.playbackState=i.PLAYING_STATE,e.task=this.nodes.map((function(t){return t instanceof s&&t.func})).filter((function(t){return!!t})),e.i=e.j=0,e.imax=e.doNum,e.jmax=e.task.length,t=e.initFunc(),i.isDictionary(t)||(t={param:t}),e.args=t},a=function(t){return function(){t.playbackState=i.FINISHED_STATE;var e=t._,n=t.cells[0],s=t.cells[1],r=t.cells[2],a=e.args;if("number"==typeof a)for(var o=0,u=s.length;u>o;++o)n[0]=s[o]=r[o]=a;e.emit("ended",e.args)}},o=e.prototype;Object.defineProperties(o,{do:{set:function(t){"number"==typeof t&&t>0&&(this._.doNum=1/0===t?1/0:0|t)},get:function(){return this._.doNum}},init:{set:function(t){"function"==typeof t&&(this._.initFunc=t)},get:function(){return this._.initFunc}}}),o.bang=function(){var t=this._;return t.count=0,t.emit("bang"),this},o.wait=function(t){return"string"==typeof t&&(t=n(t)),"number"==typeof t&&t>0&&(this._.count+=this._.samplerate*t*.001|0),this},o.process=function(t){var e,n=this.cells[0],s=this._;if(this.tickID!==t&&(this.tickID=t,s.i<s.imax)){for(;s.count<=0;){if(s.j>=s.jmax){if(++s.i,s.i>=s.imax){i.nextTick(s.onended);break}s.j=0}(e=s.task[s.j++])&&e.call(this,s.i,s.args)}s.count-=n.length}return this},i.register("task",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,0,e),i.timer(this),i.fixKR(this);var n=this._;this.playbackState=i.FINISHED_STATE,n.currentTime=0,n.samplesMax=0,n.samples=0,n.onended=i.make_onended(this),this.once("init",s),this.on("start",r)}var i=t.fn,n=t.timevalue;i.extend(e);var s=function(){this._.timeout||(this.timeout=1e3)},r=function(){this.playbackState=i.PLAYING_STATE};Object.defineProperty(r,"unremovable",{value:!0,writable:!1});var a=e.prototype;Object.defineProperties(a,{timeout:{set:function(t){var e=this._;"string"==typeof t&&(t=n(t)),"number"==typeof t&&t>=0&&(this.playbackState=i.PLAYING_STATE,e.timeout=t,e.samplesMax=.001*e.samplerate*t|0,e.samples=e.samplesMax)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}}),a.bang=function(){var t=this._;return this.playbackState=i.PLAYING_STATE,t.samples=t.samplesMax,t.currentTime=0,t.emit("bang"),this},a.process=function(t){var e=this.cells[0],n=this._;if(this.tickID!==t){if(this.tickID=t,n.samples>0&&(n.samples-=e.length),n.samples<=0){for(var s=this.nodes,r=0,a=s.length;a>r;++r)s[r].bang();i.nextTick(n.onended)}n.currentTime+=i.currentTimeIncr}return this},i.register("timeout",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e),i.fixAR(this),this._.curve=null}var i=t.fn;i.extend(e);var n=e.prototype;Object.defineProperties(n,{curve:{set:function(t){i.isSignalArray(t)&&(this._.curve=t)},get:function(){return this._.curve}}}),n.process=function(t){var e=this._;if(this.tickID!==t){if(this.tickID=t,i.inputSignalAR(this),e.curve){var n,s,r=this.cells[0],a=e.curve,o=a.length,u=e.cellsize;for(s=0;u>s;++s)0>(n=.5*(r[s]+1)*o+.5|0)?n=0:n>=o-1&&(n=o-1),r[s]=a[n]}i.outputSignalAR(this)}return this},i.register("waveshaper",e)}(timbre),function(t){"use strict";function e(e){t.Object.call(this,1,e);var i=this._;i.inMin=0,i.inMax=1,i.outMin=0,i.outMax=1,i.ar=!1,this.once("init",n)}var i=t.fn;i.extend(e);var n=function(){this._.warp||(this.warp="linlin")},s=e.prototype;Object.defineProperties(s,{inMin:{set:function(t){"number"==typeof t&&(this._.inMin=t)},get:function(){return this._.inMin}},inMax:{set:function(t){"number"==typeof t&&(this._.inMax=t)},get:function(){return this._.inMax}},outMin:{set:function(t){"number"==typeof t&&(this._.outMin=t)},get:function(){return this._.outMin}},outMax:{set:function(t){"number"==typeof t&&(this._.outMax=t)},get:function(){return this._.outMax}},warp:{set:function(t){if("string"==typeof t){var e=r[t];e&&(this._.warp=e,this._.warpName=t)}},get:function(){return this._.warpName}}}),s.process=function(t){var e=this._,n=this.cells[0];if(this.tickID!==t){this.tickID=t;var s,r=e.inMin,a=e.inMax,o=e.outMin,u=e.outMax,h=e.warp,l=this.nodes.length,c=e.mul,f=e.add,p=n.length;if(e.ar&&l){for(i.inputSignalAR(this),s=0;p>s;++s)n[s]=h(n[s],r,a,o,u)*c+f;i.outputSignalAR(this)}else{var d=h(this.nodes.length?i.inputSignalKR(this):0,r,a,o,u)*c+f;for(s=0;p>s;++s)n[s]=d}}return this};var r={linlin:function(t,e,i,n,s){return e>t?n:t>i?s:i===e?n:(t-e)/(i-e)*(s-n)+n},linexp:function(t,e,i,n,s){return e>t?n:t>i?s:0===n?0:i===e?s:Math.pow(s/n,(t-e)/(i-e))*n},explin:function(t,e,i,n,s){return e>t?n:t>i||0===e?s:Math.log(t/e)/Math.log(i/e)*(s-n)+n},expexp:function(t,e,i,n,s){return e>t?n:t>i?s:0===e||0===n?0:Math.pow(s/n,Math.log(t/e)/Math.log(i/e))*n}};i.register("zmap",e)}(timbre)}).call(this,i(2))},function(t,e,i){t.exports=i(6)},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e){!function(t){"use strict";if("browser"===t.envtype){var e=t.fn,i=null;e.extend(f);var n={},s=!1,r=!1,a=!1,o=function(t){for(var e=i._,o=i.cells[0],u=t.keyCode*e.mul+e.add,h=0,l=o.length;h<l;++h)o[h]=u;s=t.shiftKey,r=t.ctrlKey,a=t.altKey,n[t.keyCode]||(n[t.keyCode]=!0,i._.emit("keydown",t))},u=function(t){delete n[t.keyCode],i._.emit("keyup",t)},h=f.prototype;Object.defineProperties(h,{shiftKey:{get:function(){return s}},ctrlKey:{get:function(){return r}},altKey:{get:function(){return a}}}),h.start=function(){return window.addEventListener("keydown",o,!0),window.addEventListener("keyup",u,!0),this},h.stop=function(){return window.removeEventListener("keydown",o,!0),window.removeEventListener("keyup",u,!0),this},h.play=h.pause=function(){return this},e.register("keyboard",f);var l={90:48,83:49,88:50,68:51,67:52,86:53,71:54,66:55,72:56,78:57,74:58,77:59,188:60,76:61,190:62,186:63,81:60,50:61,87:62,51:63,69:64,82:65,53:66,84:67,54:68,89:69,55:70,85:71,73:72,57:73,79:74,48:75,80:76},c=e.getClass("ndict");e.register("ndict.key",(function(t){var e=new c(t);return e.dict=l,e}))}function f(n){if(i)return i;i=this,t.Object.call(this,1,n),e.fixKR(this)}}(timbre)},function(t,e){!function(t){"use strict";var e=t.fn;function i(e){t.Object.call(this,1,e);var i=this._;i.defaultValue=0,i.index=0,i.dict={},i.ar=!1}e.extend(i);var n=i.prototype;Object.defineProperties(n,{dict:{set:function(t){if("object"==typeof t)this._.dict=t;else if("function"==typeof t){for(var e={},i=0;i<128;++i)e[i]=t(i);this._.dict=e}},get:function(){return this._.dict}},defaultValue:{set:function(t){"number"==typeof t&&(this._.defaultValue=t)},get:function(){return this._.defaultValue}},index:{set:function(t){"number"==typeof t&&(this._.index=t)},get:function(){return this._.index}}}),n.at=function(t){var e=this._;return(e.dict[0|t]||e.defaultValue)*e.mul+e.add},n.clear=function(){return this._.dict={},this},n.process=function(t){var i=this.cells[0],n=this._;if(this.tickID!==t){this.tickID=t;var s,r,a,o=this.nodes.length,u=n.dict,h=n.defaultValue,l=n.mul,c=n.add,f=i.length;if(n.ar&&o){for(e.inputSignalAR(this),a=0;a<f;++a)s=(s=i[a])<0?s-.5|0:s+.5|0,i[a]=(u[s]||h)*l+c;e.outputSignalAR(this)}else for(r=(u[s=(s=this.nodes.length?e.inputSignalKR(this):n.index)<0?s-.5|0:s+.5|0]||h)*l+c,a=0;a<f;++a)i[a]=r}return this},e.register("ndict",i)}(timbre)},function(t,e){!function(t){"use strict";var e=t.fn;function i(e){t.Object.call(this,1,e);var i=this._;i.midi=0,i.value=0,i.prev=null,i.a4=440,i.ar=!1}e.extend(i);var n=i.prototype;Object.defineProperties(n,{midi:{set:function(t){"number"==typeof t&&(this._.midi=t)},get:function(){return this._.midi}},a4:{set:function(t){"number"==typeof t&&(this._.a4=t,this._.prev=null)},get:function(){return this._.a4}}}),n.bang=function(){return this._.prev=null,this._.emit("bang"),this},n.at=function(t){return this._.a4*Math.pow(2,(t-69)/12)},n.process=function(t){var i=this._;if(this.tickID!==t){this.tickID=t;var n,s=this.cells[0],r=this.nodes.length,a=s.length;if(i.ar&&r){e.inputSignalAR(this);var o=i.a4;for(n=0;n<a;++n)s[n]=o*Math.pow(2,(s[n]-69)/12);i.value=s[a-1],e.outputSignalAR(this)}else{var u=r?e.inputSignalKR(this):i.midi;i.prev!==u&&(i.prev=u,i.value=i.a4*Math.pow(2,(u-69)/12)),s[0]=i.value,e.outputSignalKR(this)}}return this},e.register("midicps",i)}(timbre)},function(t,e,i){"use strict";i.r(e);var n=i.p+"400d2370eb6d524162ff336745277b42.png",s=i.p+"3fd4a6865c4656dc64451f64ffc68e12.png";const r={C:["c","d","e","f","g","a","b"],G:["c","d","e","f+","g","a","b"],D:["c+","d","e","f+","g","a","b"],A:["c+","d","e","f+","g+","a","b"],E:["c+","d+","e","f+","g+","a","b"],B:["c+","d+","e","f+","g+","a+","b"],"F+":["c+","d+","e+","f+","g+","a+","b"],"C+":["c+","d+","e+","f+","g+","a+","b+"],F:["c","d","e","f","g","a","b-"],"B-":["c","d","e-","f","g","a","b-"],"E-":["c","d","e-","f","g","a-","b-"],"A-":["c","d-","e-","f","g","a-","b-"],"D-":["c","d-","e-","f","g-","a-","b-"],"G-":["c-","d-","e-","f","g-","a-","b-"],"C-":["c-","d-","e-","f-","g-","a-","b-"]},a=[2,4,8,16,8/3],o=a.length;var u,h,l,c,f=!1,p="mallet";function d(t){var e;let i;for(let n=0;n<4;n++)i="sound"+n,e=document.getElementById(i),i==t.target.id?p=t.target.name:e.checked=!1}document.getElementById("start").addEventListener("click",(function(){var t=document.getElementById("key").value,e=parseInt(document.getElementById("tempo").value);if(u=i(0),f)document.getElementById("start").style.background="rgb(129, 166, 201)",document.getElementById("start").value="play",o(),f=!1;else{document.getElementById("start").value="stop",document.getElementById("start").style.background="rgb(96, 135, 172)";for(var n=[],s=1;s>0;)s=b(n,s);var r=_(n,t);let i=y(n,r);for(n=[],s=1;s>0;)s=b(n,s);r=_(n,t);y(n,r);var a=function(t,e){let i="";return i+="l"+t+" ",i+="t"+e+" ",i}(4,e);for(let t=0;t<300;t++)a+=i;g(),l=u("mml",{mml:a},h).on("ended",o).start(),f=!0}function o(){h.pause(),l.stop()}})),document.getElementById("start").addEventListener("mouseover",(function(){document.getElementById("start").style.background="rgb(96, 135, 172)"})),document.getElementById("start").addEventListener("mouseout",(function(){f||(document.getElementById("start").style.background="rgb(129, 166, 201)")}));for(var m=document.getElementsByClassName("sound"),v=0;v<m.length;v++)m[v].addEventListener("click",d);function g(){if("mallet"==p)h=u("OscGen",{wave:"sin",env:{type:"perc"},mul:.25}).play();else if("synth"==p){var t=u("pulse"),e=u("perc",{a:50,r:2500});h=u("OscGen",{osc:t,env:e,mul:.1}).play()}else if("guitar"==p){e=u("perc",{a:50,r:2500});h=u("PluckGen",{env:e,mul:.5}).play()}else"kick"==p&&(h=u("OscGen",{wave:"sin",freq:2,add:3200,mul:.3,kr:10}).play())}function b(t,e){let i=a[Math.floor(Math.random()*o)];t.length;if(t.includes(2))for(;i<=2;)i=a[Math.floor(Math.random()*o)];return 1/i>e?(t.push(1/e),e=0):(t.push(i),e-=1/i),e}function _(t,e){let i=[];for(let n=0;n<t.length;n++)i.push(r[e][Math.floor(7*Math.random())]);return i}function y(t,e){let i="";for(let n=0;n<t.length;n++)i+=e[n]+t[n];return i}document.getElementById("chord").addEventListener("click",(function(){var t=document.getElementById("key").value;u=i(0);var e="l1"+r[t][Math.floor(7*Math.random())]+"0"+r[t][Math.floor(7*Math.random())];g();var n=u("mml",{mml:e},h).on("ended",(function(){h.pause(),n.stop()})).start()})),document.getElementById("info").addEventListener("change",(function(){if(document.getElementById("info").checked){$(document.getElementById("mobile-keyboard")).focus(),$(document.getElementById("info")).trigger("focus"),document.getElementById("mapping").style.visibility="visible",document.getElementById("info").innerHTML="turn keyboard off",!0;var t,e,n,s=i(0);i(3),i(4),i(5);var r=s("perc",{r:700});t=s("OscGen",{wave:"sin",env:r,mul:.2}).play(),e=s("ndict.key"),n=s("midicps"),c=s("keyboard").on("keydown",(function(i){var s=e.at(i.keyCode);if(s){var r=n.at(s);t.noteOnWithFreq(r,100)}})).on("keyup",(function(i){var n=e.at(i.keyCode);n&&t.noteOff(n,100)})).start()}else document.getElementById("mapping").style.visibility="hidden",document.getElementById("info").innerHTML="turn keyboard on",c.stop(),!1})),document.getElementById("tempo").addEventListener("onchange",(function(){let t=document.getElementById("tempo").value;console.log("H"),document.getElementById("tempo-text").value=t})),document.getElementById("mapping").src=n,document.getElementById("waves").src=s}]);
//# sourceMappingURL=main.f6fe2a1b9c0e9bdfb4cd.js.map